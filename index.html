<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  
  <title>Hexo</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta property="og:type" content="website">
<meta property="og:title" content="Hexo">
<meta property="og:url" content="http://example.com/index.html">
<meta property="og:site_name" content="Hexo">
<meta property="og:locale" content="en_US">
<meta property="article:author" content="John Doe">
<meta name="twitter:card" content="summary">
  
    <link rel="alternate" href="/atom.xml" title="Hexo" type="application/atom+xml">
  
  
    <link rel="shortcut icon" href="/favicon.png">
  
  
    
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/typeface-source-code-pro@0.0.71/index.min.css">

  
  
<link rel="stylesheet" href="/css/style.css">

  
    
<link rel="stylesheet" href="/fancybox/jquery.fancybox.min.css">

  
<meta name="generator" content="Hexo 6.0.0"></head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">Hexo</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://example.com"></form>
      </div>
    </div>
  </div>
</header>

      <div class="outer">
        <section id="main">
  
    <article id="post-CacheLab" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2022/02/23/CacheLab/" class="article-date">
  <time class="dt-published" datetime="2022-02-23T14:10:28.433Z" itemprop="datePublished">2022-02-23</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h1 id="CacheLab"><a href="#CacheLab" class="headerlink" title="CacheLab"></a>CacheLab</h1><h2 id="前期准备"><a href="#前期准备" class="headerlink" title="前期准备"></a>前期准备</h2><blockquote>
<p><a target="_blank" rel="noopener" href="http://www.cs.cmu.edu/afs/cs/academic/class/15213-f15/www/recitations/rec07.pdf">评分标准</a></p>
<p><a target="_blank" rel="noopener" href="http://www.cs.cmu.edu/afs/cs/academic/class/15213-f15/www/recitations/rec07.pdf">相关ppt</a></p>
</blockquote>
<h3 id="安装valgrind内存泄露检测工具。"><a href="#安装valgrind内存泄露检测工具。" class="headerlink" title="安装valgrind内存泄露检测工具。"></a>安装valgrind内存泄露检测工具。</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo apt install valgrind</span><br></pre></td></tr></table></figure>

<h3 id="相关参数"><a href="#相关参数" class="headerlink" title="相关参数"></a>相关参数</h3><p>1、</p>
<img src="C:\Users\DELL\AppData\Roaming\Typora\typora-user-images\image-20220227165149385.png" alt="图片" style="zoom:50%;" />



<img src="C:\Users\DELL\AppData\Roaming\Typora\typora-user-images\image-20220227165226934.png" alt="结构层次" style="zoom:50%;" />



<h3 id="输入模式"><a href="#输入模式" class="headerlink" title="输入模式"></a>输入模式</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">I 0400d7d4,8</span><br><span class="line">M 0421c7f0,4</span><br><span class="line">L 04f6b868,8</span><br><span class="line">S 7ff0005c8,8</span><br></pre></td></tr></table></figure>

<p>The operation field denotes the type of memory access: “I” denotes an instruction load, “L” a data load, “S” a data store, and “M” a data modify (i.e., a data load followed by a data store). There is never a space before each “I”. There is always a space before each “M”, “L”, and “S”. The address field specifies a 64-bit hexadecimal memory address. The size field specifies the number of bytes accessed by the operation.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">Usage: ./csim-ref [-hv] -s &lt;s&gt; -E &lt;E&gt; -b &lt;b&gt; -t &lt;tracefile&gt;</span><br><span class="line">• -h: Optional help flag that prints usage info</span><br><span class="line">• -v: Optional verbose flag that displays trace info</span><br><span class="line">• -s &lt;s&gt;: Number of set index bits (S = 2^s is the number of sets)</span><br><span class="line">• -E &lt;E&gt;: Associativity (number of lines per set)</span><br><span class="line">• -b &lt;b&gt;: Number of block bits (B = 2^b is the block size)</span><br><span class="line">• -t &lt;tracefile&gt;: Name of the valgrind trace to replay</span><br></pre></td></tr></table></figure>

<p> 分析：</p>
<p>​        I 、M 、L 、S  为操作模式，I 为取指令，在本次lab里可以忽略；M 为修改，先取后存；L 为 load ；S 为store</p>
<p>​        地址为最重要的参数，需要根据输入的  <code>S</code>  <code>E</code> <code>B</code> 来确定，采取组相联的模式</p>
<p>​        地址分解函数如下：</p>
 <figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Split</span><span class="params">(<span class="keyword">unsigned</span> <span class="keyword">int</span> *address_c,<span class="keyword">unsigned</span> <span class="keyword">long</span> address)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> mask1=<span class="number">1</span>,mask2=<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;s<span class="number">-1</span>;i++)</span><br><span class="line">    &#123;</span><br><span class="line">        mask1=mask1&lt;&lt;<span class="number">1</span>;</span><br><span class="line">        mask1=mask1|<span class="number">0x1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;s+b<span class="number">-1</span>;i++)</span><br><span class="line">    &#123;</span><br><span class="line">        mask2=mask2&lt;&lt;<span class="number">1</span>;</span><br><span class="line">        mask2=mask2|<span class="number">0x1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    address_c[<span class="number">0</span>]=<span class="number">0</span>; <span class="comment">//偏移量</span></span><br><span class="line">    address_c[<span class="number">1</span>]=(address&gt;&gt;b)&amp;(mask1); <span class="comment">//组号</span></span><br><span class="line">    address_c[<span class="number">2</span>]=((address&gt;&gt;(b+s)));   <span class="comment">//标志位</span></span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h3 id="调试方法"><a href="#调试方法" class="headerlink" title="调试方法"></a>调试方法</h3><p> 1、标准测试</p>
 <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./test-csim</span><br></pre></td></tr></table></figure>

<p>2、标准cache测试</p>
 <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./csim-ref -v -s 2 -E 2 -b 3 -t traces/trans.trace</span><br></pre></td></tr></table></figure>

<p>3、自行测试</p>
 <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./csim -v -s 2 -E 2 -b 3 -t traces/trans.trace</span><br></pre></td></tr></table></figure>



<h2 id="代码与注释"><a href="#代码与注释" class="headerlink" title="代码与注释"></a>代码与注释</h2><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&quot;cachelab.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&quot;stdio.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&quot;getopt.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span>  <span class="meta-string">&lt;unistd.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&quot;string.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&quot;stdlib.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&quot;math.h&quot;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">char</span> *usage =<span class="string">&quot;Usage: ./csim-ref [-hv] -s &lt;s&gt; -E &lt;E&gt; -b &lt;b&gt; -t &lt;tracefile&gt;\n&quot;</span>;</span><br><span class="line"><span class="keyword">int</span> v,h,s,E,b,t,S;</span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">int</span> mask1=<span class="number">1</span>,mask2=<span class="number">1</span>;</span><br><span class="line"><span class="keyword">int</span> hits=<span class="number">0</span>,misss=<span class="number">0</span>,evictions=<span class="number">0</span>;</span><br><span class="line"><span class="keyword">char</span> file[<span class="number">1000</span>];</span><br><span class="line"><span class="comment">//cache 采用二维动态数组建立</span></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Cache</span>    </span></span><br><span class="line"><span class="class">&#123;</span> </span><br><span class="line">    <span class="keyword">int</span> vaild; <span class="comment">//有效位 （未使用）</span></span><br><span class="line">    <span class="keyword">int</span> tag;   <span class="comment">//标志位</span></span><br><span class="line">    <span class="keyword">int</span> LRU_flag; <span class="comment">//LRU 标志位</span></span><br><span class="line">&#125;cache_block,*cache_set,**cache;  </span><br><span class="line"><span class="comment">//命中後，hits++，  更新LRU_flag</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">HIt</span><span class="params">(struct Cache *cache_set,<span class="keyword">int</span> hit_num)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    hits++;</span><br><span class="line">    <span class="keyword">if</span>(v==<span class="number">1</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot; hit&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;E;i++)</span><br><span class="line">    &#123;</span><br><span class="line">        cache_set[i].LRU_flag++;    <span class="comment">//采用位数法：命中或使用过的清0，未使用过的+1</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    cache_set[hit_num].LRU_flag=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//如果有空格，直接填入</span></span><br><span class="line"><span class="comment">//沒有則置換</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span>  <span class="title">Eviction</span><span class="params">(struct  Cache *<span class="built_in">set</span>,<span class="keyword">int</span> tag)</span>  <span class="comment">//置换</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    evictions++;</span><br><span class="line">    <span class="keyword">if</span>(v==<span class="number">1</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot; eviction&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">int</span> max=<span class="number">0</span>,index=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;E;i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="built_in">set</span>[i].LRU_flag&gt;max)   <span class="comment">//置换最大的数</span></span><br><span class="line">        &#123;</span><br><span class="line">            max=<span class="built_in">set</span>[i].LRU_flag; </span><br><span class="line">            index=i;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">set</span>[i].LRU_flag++;      <span class="comment">//最开始将这句话遗忘了，置换以后也要将其他的+1；</span></span><br><span class="line">     &#125;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">set</span>[index].LRU_flag=<span class="number">0</span>;</span><br><span class="line">    <span class="built_in">set</span>[index].tag=tag;</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Miss</span><span class="params">(struct Cache *<span class="built_in">set</span>,<span class="keyword">int</span> tag)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    misss++;</span><br><span class="line">    <span class="keyword">if</span>(v==<span class="number">1</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot; miss&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;E;i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="built_in">set</span>[i].vaild==<span class="number">0</span>)    <span class="comment">//如果还有空闲块</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="built_in">set</span>[i].vaild=<span class="number">1</span>;</span><br><span class="line">            <span class="built_in">set</span>[i].tag=tag;</span><br><span class="line">            <span class="built_in">set</span>[i].LRU_flag=<span class="number">0</span>; <span class="comment">///未完成</span></span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">    Eviction(<span class="built_in">set</span>,tag);</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//寻找cache里面是否有对应的块</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Search</span><span class="params">(<span class="keyword">unsigned</span> <span class="keyword">long</span> address,<span class="keyword">unsigned</span> <span class="keyword">int</span> *address_c)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> <span class="built_in">set</span>,flag;</span><br><span class="line">    <span class="built_in">set</span>=address_c[<span class="number">1</span>];</span><br><span class="line">    flag=address_c[<span class="number">2</span>];</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;E;i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span>(cache[<span class="built_in">set</span>][i].tag==flag)</span><br><span class="line">        &#123;</span><br><span class="line">            HIt(cache[<span class="built_in">set</span>],i);</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    Miss(cache[<span class="built_in">set</span>],address_c[<span class="number">2</span>]);</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//分解地址函数</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Split</span><span class="params">(<span class="keyword">unsigned</span> <span class="keyword">int</span> *address_c,<span class="keyword">unsigned</span> <span class="keyword">long</span> address)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"></span><br><span class="line">    address_c[<span class="number">0</span>]=<span class="number">0</span>;</span><br><span class="line">    address_c[<span class="number">1</span>]=(address&gt;&gt;b)&amp;(mask1);</span><br><span class="line">    address_c[<span class="number">2</span>]=((address&gt;&gt;(b+s)));</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">init_Cache</span><span class="params">(<span class="keyword">int</span> s, <span class="keyword">int</span> E,<span class="keyword">int</span> b)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    cache=<span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(cache_set)*S);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i =<span class="number">0</span> ; i &lt; S ; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        cache[i]=<span class="built_in">malloc</span>(<span class="keyword">sizeof</span> (cache_block)*E);</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> j=<span class="number">0</span>;j&lt;E;j++)</span><br><span class="line">        &#123;</span><br><span class="line">            cache[i][j].tag=<span class="number">-1</span>;</span><br><span class="line">            cache[i][j].LRU_flag=<span class="number">0</span>;</span><br><span class="line">            cache[i][j].vaild=<span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//读取文件</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">trace_test</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    FILE *pFile;</span><br><span class="line">    pFile = fopen(file,<span class="string">&quot;r&quot;</span>);</span><br><span class="line">    <span class="keyword">if</span>(pFile==<span class="literal">NULL</span>)</span><br><span class="line">        <span class="built_in">exit</span>(<span class="number">-1</span>);</span><br><span class="line">    <span class="keyword">char</span> identifier;</span><br><span class="line">    <span class="keyword">unsigned</span> <span class="keyword">long</span> address;</span><br><span class="line">    <span class="keyword">int</span> size;</span><br><span class="line">    <span class="keyword">unsigned</span> <span class="keyword">int</span> address_c[<span class="number">3</span>];</span><br><span class="line">    <span class="keyword">while</span>(<span class="built_in">fscanf</span>(pFile,<span class="string">&quot; %c %lx,%d&quot;</span>,&amp;identifier,&amp;address,&amp;size)&gt;<span class="number">0</span>)   <span class="comment">//在读文件的时候，fscanf要判断条件要&gt;0,否则没有结束</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">//<span class="doctag">TODO:</span></span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">switch</span> (identifier) &#123;</span><br><span class="line">            <span class="keyword">case</span> <span class="string">&#x27;I&#x27;</span>:</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> <span class="string">&#x27;L&#x27;</span>:</span><br><span class="line">                <span class="keyword">if</span>(v==<span class="number">1</span>)</span><br><span class="line">                &#123;</span><br><span class="line">                    <span class="built_in">printf</span>(<span class="string">&quot;%c %lx %d,&quot;</span>,identifier,address,size);</span><br><span class="line">                &#125;</span><br><span class="line">                Split(address_c,address);</span><br><span class="line">                Search(address,address_c);</span><br><span class="line">                <span class="keyword">if</span>(v==<span class="number">1</span>)</span><br><span class="line">                    <span class="built_in">printf</span>(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> <span class="string">&#x27;S&#x27;</span>:</span><br><span class="line">                <span class="keyword">if</span>(v==<span class="number">1</span>)</span><br><span class="line">                &#123;</span><br><span class="line">                    <span class="built_in">printf</span>(<span class="string">&quot;%c %lx %d,&quot;</span>,identifier,address,size);</span><br><span class="line">                &#125;</span><br><span class="line">                Split(address_c,address);</span><br><span class="line">                Search(address,address_c);</span><br><span class="line">                <span class="keyword">if</span>(v==<span class="number">1</span>)</span><br><span class="line">                    <span class="built_in">printf</span>(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> <span class="string">&#x27;M&#x27;</span>:</span><br><span class="line">                <span class="keyword">if</span>(v==<span class="number">1</span>)</span><br><span class="line">                &#123;</span><br><span class="line">                    <span class="built_in">printf</span>(<span class="string">&quot;%c %lx %d,&quot;</span>,identifier,address,size);</span><br><span class="line">                &#125;</span><br><span class="line">                Split(address_c,address);</span><br><span class="line">                Search(address,address_c);</span><br><span class="line">                Search(address,address_c);</span><br><span class="line">                <span class="keyword">if</span>(v==<span class="number">1</span>)</span><br><span class="line">                    <span class="built_in">printf</span>(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">    fclose(pFile);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc ,<span class="keyword">char</span>** argv)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> opt;</span><br><span class="line">    <span class="keyword">while</span>(<span class="number">-1</span>!=(opt = getopt(argc, argv,<span class="string">&quot;vhs:E:b:t:&quot;</span>)))  <span class="comment">//分解操作符</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">switch</span>(opt)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">case</span> <span class="string">&#x27;h&#x27;</span>:</span><br><span class="line">                <span class="built_in">puts</span>(usage);</span><br><span class="line">                <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">            <span class="keyword">case</span><span class="number">&#x27;</span>v<span class="number">&#x27;</span>:</span><br><span class="line">                v = <span class="number">1</span>;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> <span class="string">&#x27;s&#x27;</span>:</span><br><span class="line">                s = atoi(optarg);</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> <span class="string">&#x27;E&#x27;</span>:</span><br><span class="line">                E = atoi(optarg);</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> <span class="string">&#x27;b&#x27;</span>:</span><br><span class="line">                b=atoi(optarg);</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> <span class="string">&#x27;t&#x27;</span>:</span><br><span class="line">                <span class="built_in">strcpy</span>(file, optarg);</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">default</span>:</span><br><span class="line">                <span class="built_in">printf</span>(<span class="string">&quot;wrong argument\n&quot;</span>);</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(s&lt;=<span class="number">0</span> || E&lt;=<span class="number">0</span> || b&lt;=<span class="number">0</span> || file==<span class="literal">NULL</span>) <span class="comment">// 如果选项参数不合格就退出</span></span><br><span class="line">        <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line"></span><br><span class="line">    S=<span class="number">1</span>&lt;&lt;s;   <span class="comment">//S=2^s</span></span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;s<span class="number">-1</span>;i++)</span><br><span class="line">    &#123;</span><br><span class="line">        mask1=mask1&lt;&lt;<span class="number">1</span>;</span><br><span class="line">        mask1=mask1|<span class="number">0x1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;s+b<span class="number">-1</span>;i++)</span><br><span class="line">    &#123;</span><br><span class="line">        mask2=mask2&lt;&lt;<span class="number">1</span>;</span><br><span class="line">        mask2=mask2|<span class="number">0x1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    init_Cache(s,E,b);  <span class="comment">//初始化cache内存空间</span></span><br><span class="line">    trace_test();    </span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span> ;i&lt;S;i++)   <span class="comment">//释放空间</span></span><br><span class="line">        <span class="built_in">free</span>(cache[i]);</span><br><span class="line">    <span class="built_in">free</span>(cache);</span><br><span class="line"></span><br><span class="line">    printSummary(hits, misss, evictions);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>


      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2022/02/23/CacheLab/" data-id="cl0522zgg0000twugh3uy1dah" data-title="" class="article-share-link">Share</a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-Docker 从入门到入土" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2022/02/23/Docker%20%E4%BB%8E%E5%85%A5%E9%97%A8%E5%88%B0%E5%85%A5%E5%9C%9F/" class="article-date">
  <time class="dt-published" datetime="2022-02-23T07:25:00.907Z" itemprop="datePublished">2022-02-23</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h1 id="Docker-从入门到入土"><a href="#Docker-从入门到入土" class="headerlink" title="Docker 从入门到入土"></a>Docker 从入门到入土</h1><blockquote>
<p>–郭域</p>
</blockquote>
<h2 id="一、Docker是什么"><a href="#一、Docker是什么" class="headerlink" title="一、Docker是什么"></a>一、Docker是什么</h2><blockquote>
<p><a target="_blank" rel="noopener" href="https://yeasy.gitbook.io/docker_practice/introduction/what">Docker是什么</a></p>
</blockquote>
<h2 id="二、Docker三大组件"><a href="#二、Docker三大组件" class="headerlink" title="二、Docker三大组件"></a>二、Docker三大组件</h2><h3 id="1、Docker镜像"><a href="#1、Docker镜像" class="headerlink" title="1、Docker镜像"></a>1、Docker镜像</h3><p><strong>Docker 镜像</strong> 是一个特殊的文件系统，除了提供容器运行时所需的程序、库、资源、配置等文件外，还包含了一些为运行时准备的一些配置参数（如匿名卷、环境变量、用户等）。镜像 <strong>不包含</strong> 任何动态数据，其内容在构建之后也不会被改变。</p>
<h3 id="2、Docker容器"><a href="#2、Docker容器" class="headerlink" title="2、Docker容器"></a>2、Docker容器</h3><p>镜像（<code>Image</code>）和容器（<code>Container</code>）的关系，就像是面向对象程序设计中的 <code>类</code> 和 <code>实例</code> 一样，镜像是静态的定义，容器是镜像运行时的实体。容器可以被创建、启动、停止、删除、暂停等。</p>
<p>容器的实质是进程，但与直接在宿主执行的进程不同，容器进程运行于属于自己的独立的 <a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/Linux_namespaces">命名空间</a>。因此容器可以拥有自己的 <code>root</code> 文件系统、自己的网络配置、自己的进程空间，甚至自己的用户 ID 空间。容器内的进程是运行在一个隔离的环境里，使用起来，就好像是在一个独立于宿主的系统下操作一样。这种特性使得容器封装的应用比直接在宿主运行更加安全。也因为这种隔离的特性，很多人初学 Docker 时常常会混淆容器和虚拟机。</p>
<h3 id="3、Docker仓库"><a href="#3、Docker仓库" class="headerlink" title="3、Docker仓库"></a>3、Docker仓库</h3><h2 id="三、使用Docker"><a href="#三、使用Docker" class="headerlink" title="三、使用Docker"></a>三、使用Docker</h2><h3 id="1、-获取镜像"><a href="#1、-获取镜像" class="headerlink" title="1、 获取镜像"></a>1、 获取镜像</h3><p>之前提到过，<a target="_blank" rel="noopener" href="https://hub.docker.com/search?q=&type=image">Docker Hub</a> 上有大量的高质量的镜像可以用，这里我们就说一下怎么获取这些镜像。</p>
<p>从 Docker 镜像仓库获取镜像的命令是 <code>docker pull</code>。其命令格式为：</p>
<blockquote>
<p>$ docker pull [选项] [Docker Registry 地址[:端口号]/]仓库名[:标签]</p>
</blockquote>
<p>具体的选项可以通过 <code>docker pull --help</code> 命令看到，这里我们说一下镜像名称的格式。</p>
<p><code>Docker 镜像仓库地址：地址的格式一般是 </code>&lt;域名/IP&gt;[:端口号]<code>。默认地址是 Docker Hub(</code>docker.io`)。</p>
<p><code>仓库名：如之前所说，这里的仓库名是两段式名称，即 </code>&lt;用户名&gt;/&lt;软件名&gt;<code>。对于 Docker Hub，如果不给出用户名，则默认为 </code>library`，也就是官方镜像。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker pull ubuntu:18.04</span><br></pre></td></tr></table></figure>

<h3 id="2、运行镜像"><a href="#2、运行镜像" class="headerlink" title="2、运行镜像"></a>2、运行镜像</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">$ docker run -it --rm ubuntu:18.04 bash</span><br><span class="line"></span><br><span class="line">root@e7009c6ce357:/# cat /etc/os-release</span><br><span class="line">NAME=&quot;Ubuntu&quot;</span><br><span class="line">VERSION=&quot;18.04.1 LTS (Bionic Beaver)&quot;</span><br><span class="line">ID=ubuntu</span><br><span class="line">ID_LIKE=debian</span><br><span class="line">PRETTY_NAME=&quot;Ubuntu 18.04.1 LTS&quot;</span><br><span class="line">VERSION_ID=&quot;18.04&quot;</span><br><span class="line">HOME_URL=&quot;https://www.ubuntu.com/&quot;</span><br><span class="line">SUPPORT_URL=&quot;https://help.ubuntu.com/&quot;</span><br><span class="line">BUG_REPORT_URL=&quot;https://bugs.launchpad.net/ubuntu/&quot;</span><br><span class="line">PRIVACY_POLICY_URL=&quot;https://www.ubuntu.com/legal/terms-and-policies/privacy-policy&quot;</span><br><span class="line">VERSION_CODENAME=bionic</span><br><span class="line">UBUNTU_CODENAME=bionic</span><br></pre></td></tr></table></figure>

<p><code>docker run</code> 就是运行容器的命令，具体格式我们会在 <a href="">容器</a> 一节进行详细讲解，我们这里简要的说明一下上面用到的参数。</p>
<blockquote>
<p> <code>-it</code>：这是两个参数，一个是 <code>-i</code>：交互式操作，一个是 <code>-t</code> 终端。我们这里打算进入 <code>bash</code> 执行一些命令并查看返回结果，因此我们需要交互式终端。</p>
</blockquote>
<blockquote>
<p><code>--rm</code>：这个参数是说容器退出后随之将其删除。默认情况下，为了排障需求，退出的容器并不会立即删除，除非手动 <code>docker rm</code>。我们这里只是随便执行个命令，看看结果，不需要排障和保留结果，因此使用 <code>--rm</code> 可以避免浪费空间。</p>
</blockquote>
<blockquote>
<p><code>ubuntu:18.04</code>：这是指用 <code>ubuntu:18.04</code> 镜像为基础来启动容器。</p>
</blockquote>
<blockquote>
<p><code>bash</code>：放在镜像名后的是 <strong>命令</strong>，这里我们希望有个交互式 Shell，因此用的是 <code>bash</code>。</p>
</blockquote>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2022/02/23/Docker%20%E4%BB%8E%E5%85%A5%E9%97%A8%E5%88%B0%E5%85%A5%E5%9C%9F/" data-id="cl0522zgk0002twug64ajaw7b" data-title="" class="article-share-link">Share</a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-Lab3 Buffer lab" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2022/02/06/Lab3%20Buffer%20lab/" class="article-date">
  <time class="dt-published" datetime="2022-02-06T12:18:37.498Z" itemprop="datePublished">2022-02-06</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h1 id="Lab3-Buffer-lab"><a href="#Lab3-Buffer-lab" class="headerlink" title="Lab3 Buffer lab"></a>Lab3 Buffer lab</h1><h2 id="1、说明"><a href="#1、说明" class="headerlink" title="1、说明"></a>1、说明</h2>
      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2022/02/06/Lab3%20Buffer%20lab/" data-id="cl0522zgj0001twugb36ceeud" data-title="" class="article-share-link">Share</a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-bomblab" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2022/01/22/bomblab/" class="article-date">
  <time class="dt-published" datetime="2022-01-22T15:54:42.000Z" itemprop="datePublished">2022-01-22</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2022/01/22/bomblab/">bomblab</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h1 id="LAB2-BOMB"><a href="#LAB2-BOMB" class="headerlink" title="LAB2 BOMB"></a>LAB2 BOMB</h1><h2 id="GDB的使用"><a href="#GDB的使用" class="headerlink" title="GDB的使用"></a>GDB的使用</h2><h3 id="查看函数的汇编码"><a href="#查看函数的汇编码" class="headerlink" title="查看函数的汇编码"></a>查看函数的汇编码</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">disas phase_1  #显示代码</span><br><span class="line"></span><br><span class="line">info break    #显示断点</span><br><span class="line">d 2 #删除第二个断点</span><br><span class="line">b phase_1 #插入断点 </span><br><span class="line">next #逐过程</span><br><span class="line">step #逐语句</span><br><span class="line">info registers #查看寄存器</span><br><span class="line">（gdb）enable breakpoints：启用断点</span><br><span class="line"></span><br><span class="line">（gdb）disable breakpoints：禁用断点</span><br></pre></td></tr></table></figure>

<h3 id="x-的使用"><a href="#x-的使用" class="headerlink" title="-x 的使用"></a>-x 的使用</h3><p>可以使用examine命令(简写是x)来查看内存地址中的值。x命令的语法如下所示：</p>
<p>　　　　x/&lt;n/f/u&gt; <addr></p>
<p>　　n、f、u是可选的参数。</p>
<p>　　n是一个正整数，表示需要显示的内存单元的个数，也就是说从当前地址向后显示几个内存单元的内容，一个内存单元的大小由后面的u定义。</p>
<p>　　f 表示显示的格式，参见下面。如果地址所指的是字符串，那么格式可以是s，如果地十是指令地址，那么格式可以是i。</p>
<p>　　u 表示从当前地址往后请求的字节数，如果不指定的话，GDB默认是4个bytes。u参数可以用下面的字符来代替，b表示单字节，h表示双字节，w表示四字 节，g表示八字节。当我们指定了字节长度后，GDB会从指内存定的内存地址开始，读写指定字节，并把其当作一个值取出来。</p>
<p>　　<addr>表示一个内存地址。</p>
<p>　　注意：严格区分n和u的关系，n表示单元个数，u表示每个单元的大小。</p>
<p>　　n/f/u三个参数可以一起使用。例如：</p>
<p>　　命令：x/3uh 0x54320 表示，从内存地址0x54320读取内容，h表示以双字节为一个单位，3表示输出三个单位，u表示按无符号十进制显示。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">x/s 可以显示一个地址的字符串</span><br></pre></td></tr></table></figure>











<h2 id="第一关"><a href="#第一关" class="headerlink" title="第一关"></a>第一关</h2><p>输入指令</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">disas phase_1</span><br></pre></td></tr></table></figure>

<p>可以得到如下代码</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">0x0000000000400ee0 &lt;+0&gt;:	sub    $0x8,%rsp  #压栈必备操作</span><br><span class="line">0x0000000000400ee4 &lt;+4&gt;:	mov    $0x402400,%esi  #立即数</span><br><span class="line">0x0000000000400ee9 &lt;+9&gt;:	callq  0x401338 &lt;strings_not_equal&gt; # 比较函数，这就要和我们输入的字符串进行比较了</span><br><span class="line">0x0000000000400eee &lt;+14&gt;:	test   %eax,%eax</span><br><span class="line">0x0000000000400ef0 &lt;+16&gt;:	je     0x400ef7 &lt;phase_1+23&gt;</span><br><span class="line">0x0000000000400ef2 &lt;+18&gt;:	callq  0x40143a &lt;explode_bomb&gt;</span><br><span class="line">0x0000000000400ef7 &lt;+23&gt;:	add    $0x8,%rsp</span><br><span class="line">0x0000000000400efb &lt;+27&gt;:	retq   </span><br><span class="line"></span><br></pre></td></tr></table></figure>



<p>使用命令</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">x/s 0x402400 </span><br></pre></td></tr></table></figure>

<p>即可得到字符串</p>
<p>  “Border relations with Canada have never been better.”</p>
<h2 id="第二关"><a href="#第二关" class="headerlink" title="第二关"></a>第二关</h2><p>phase_2</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">400efc:	55                   	push   %rbp</span><br><span class="line">400efd:	53                   	push   %rbx</span><br><span class="line">400efe:	48 83 ec 28          	sub    $0x28,%rsp</span><br><span class="line">400f02:	48 89 e6             	mov    %rsp,%rsi</span><br><span class="line">400f05:	e8 52 05 00 00       	callq  40145c &lt;read_six_numbers&gt;</span><br><span class="line">400f0a:	83 3c 24 01          	cmpl   $0x1,(%rsp) #与1比较</span><br><span class="line">400f0e:	74 20                	je     400f30 &lt;phase_2+0x34&gt;</span><br><span class="line">400f10:	e8 25 05 00 00       	callq  40143a &lt;explode_bomb&gt;</span><br><span class="line">400f15:	eb 19                	jmp    400f30 &lt;phase_2+0x34&gt;</span><br><span class="line">400f17:	8b 43 fc             	mov    -0x4(%rbx),%eax</span><br><span class="line">400f1a:	01 c0                	add    %eax,%eax  #相当于*2的操作</span><br><span class="line">400f1c:	39 03                	cmp    %eax,(%rbx)</span><br><span class="line">400f1e:	74 05                	je     400f25 &lt;phase_2+0x29&gt;</span><br><span class="line">400f20:	e8 15 05 00 00       	callq  40143a &lt;explode_bomb&gt;</span><br><span class="line">400f25:	48 83 c3 04          	add    $0x4,%rbx</span><br><span class="line">400f29:	48 39 eb             	cmp    %rbp,%rbx</span><br><span class="line">400f2c:	75 e9                	jne    400f17 &lt;phase_2+0x1b&gt;</span><br><span class="line">400f2e:	eb 0c                	jmp    400f3c &lt;phase_2+0x40&gt;</span><br><span class="line">400f30:	48 8d 5c 24 04       	lea    0x4(%rsp),%rbx  </span><br><span class="line">400f35:	48 8d 6c 24 18       	lea    0x18(%rsp),%rbp</span><br><span class="line">400f3a:	eb db                	jmp    400f17 &lt;phase_2+0x1b&gt;</span><br><span class="line">400f3c:	48 83 c4 28          	add    $0x28,%rsp</span><br><span class="line">400f40:	5b                   	pop    %rbx</span><br><span class="line">400f41:	5d                   	pop    %rbp</span><br><span class="line">400f42:	c3                   	retq   </span><br></pre></td></tr></table></figure>

<p>read_six_numbers</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">0x000000000040145c &lt;+0&gt;:	sub    $0x18,%rsp</span><br><span class="line">0x0000000000401460 &lt;+4&gt;:	mov    %rsi,%rdx</span><br><span class="line">0x0000000000401463 &lt;+7&gt;:	lea    0x4(%rsi),%rcx</span><br><span class="line">0x0000000000401467 &lt;+11&gt;:	lea    0x14(%rsi),%rax  #都是输入数字的操作</span><br><span class="line">0x000000000040146b &lt;+15&gt;:	mov    %rax,0x8(%rsp)</span><br><span class="line">0x0000000000401470 &lt;+20&gt;:	lea    0x10(%rsi),%rax</span><br><span class="line">0x0000000000401474 &lt;+24&gt;:	mov    %rax,(%rsp)</span><br><span class="line">0x0000000000401478 &lt;+28&gt;:	lea    0xc(%rsi),%r9</span><br><span class="line">0x000000000040147c &lt;+32&gt;:	lea    0x8(%rsi),%r8</span><br><span class="line">0x0000000000401480 &lt;+36&gt;:	mov    $0x4025c3,%esi</span><br><span class="line">0x0000000000401485 &lt;+41&gt;:	mov    $0x0,%eax</span><br><span class="line">0x000000000040148a &lt;+46&gt;:	callq  0x400bf0 &lt;__isoc99_sscanf@plt&gt;</span><br><span class="line">0x000000000040148f &lt;+51&gt;:	cmp    $0x5,%eax</span><br><span class="line">0x0000000000401492 &lt;+54&gt;:	jg     0x401499 &lt;read_six_numbers+61&gt;</span><br><span class="line">0x0000000000401494 &lt;+56&gt;:	callq  0x40143a &lt;explode_bomb&gt;</span><br><span class="line">0x0000000000401499 &lt;+61&gt;:	add    $0x18,%rsp</span><br><span class="line">0x000000000040149d &lt;+65&gt;:	retq   </span><br><span class="line"></span><br></pre></td></tr></table></figure>



<p>1 2 4 8 16 32</p>
<h2 id="第三关"><a href="#第三关" class="headerlink" title="第三关"></a>第三关</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line">0x0000000000400f43 &lt;+0&gt;:	sub    $0x18,%rsp</span><br><span class="line">0x0000000000400f47 &lt;+4&gt;:	lea    0xc(%rsp),%rcx  #输入第一个数的地址</span><br><span class="line">0x0000000000400f4c &lt;+9&gt;:	lea    0x8(%rsp),%rdx  #输入第二个数的地址</span><br><span class="line">0x0000000000400f51 &lt;+14&gt;:	mov    $0x4025cf,%esi</span><br><span class="line">0x0000000000400f56 &lt;+19&gt;:	mov    $0x0,%eax</span><br><span class="line">0x0000000000400f5b &lt;+24&gt;:	callq  0x400bf0 &lt;__isoc99_sscanf@plt&gt;</span><br><span class="line">0x0000000000400f60 &lt;+29&gt;:	cmp    $0x1,%eax   #比较参数</span><br><span class="line">0x0000000000400f63 &lt;+32&gt;:	jg     0x400f6a &lt;phase_3+39&gt; </span><br><span class="line">0x0000000000400f65 &lt;+34&gt;:	callq  0x40143a &lt;explode_bomb&gt;</span><br><span class="line">0x0000000000400f6a &lt;+39&gt;:	cmpl   $0x7,0x8(%rsp) #第一个数要&lt;7</span><br><span class="line">0x0000000000400f6f &lt;+44&gt;:	ja     0x400fad &lt;phase_3+106&gt;</span><br><span class="line">0x0000000000400f71 &lt;+46&gt;:	mov    0x8(%rsp),%eax #把第一个参数传入eax（rax）</span><br><span class="line">0x0000000000400f75 &lt;+50&gt;:	jmpq   *0x402470(,%rax,8) #通过传入的参数跳转</span><br><span class="line">0x0000000000400f7c &lt;+57&gt;:	mov    $0xcf,%eax</span><br><span class="line">0x0000000000400f81 &lt;+62&gt;:	jmp    0x400fbe &lt;phase_3+123&gt;</span><br><span class="line">0x0000000000400f83 &lt;+64&gt;:	mov    $0x2c3,%eax</span><br><span class="line">0x0000000000400f88 &lt;+69&gt;:	jmp    0x400fbe &lt;phase_3+123&gt;</span><br><span class="line">0x0000000000400f8a &lt;+71&gt;:	mov    $0x100,%eax</span><br><span class="line">0x0000000000400f8f &lt;+76&gt;:	jmp    0x400fbe &lt;phase_3+123&gt;</span><br><span class="line">0x0000000000400f91 &lt;+78&gt;:	mov    $0x185,%eax</span><br><span class="line">0x0000000000400f96 &lt;+83&gt;:	jmp    0x400fbe &lt;phase_3+123&gt;</span><br><span class="line">0x0000000000400f98 &lt;+85&gt;:	mov    $0xce,%eax</span><br><span class="line">0x0000000000400f9d &lt;+90&gt;:	jmp    0x400fbe &lt;phase_3+123&gt;</span><br><span class="line">0x0000000000400f9f &lt;+92&gt;:	mov    $0x2aa,%eax</span><br><span class="line">0x0000000000400fa4 &lt;+97&gt;:	jmp    0x400fbe &lt;phase_3+123&gt;</span><br><span class="line">0x0000000000400fa6 &lt;+99&gt;:	mov    $0x147,%eax</span><br><span class="line">0x0000000000400fab &lt;+104&gt;:	jmp    0x400fbe &lt;phase_3+123&gt;</span><br><span class="line">0x0000000000400fad &lt;+106&gt;:	callq  0x40143a &lt;explode_bomb&gt;</span><br><span class="line">0x0000000000400fb2 &lt;+111&gt;:	mov    $0x0,%eax</span><br><span class="line">0x0000000000400fb7 &lt;+116&gt;:	jmp    0x400fbe &lt;phase_3+123&gt;</span><br><span class="line">0x0000000000400fb9 &lt;+118&gt;:	mov    $0x137,%eax</span><br><span class="line">0x0000000000400fbe &lt;+123&gt;:	cmp    0xc(%rsp),%eax  #eax与第二个参数比较，这里选择2，所以为707</span><br><span class="line">0x0000000000400fc2 &lt;+127&gt;:	je     0x400fc9 &lt;phase_3+134&gt;</span><br><span class="line">0x0000000000400fc4 &lt;+129&gt;:	callq  0x40143a &lt;explode_bomb&gt;</span><br><span class="line">0x0000000000400fc9 &lt;+134&gt;:	add    $0x18,%rsp</span><br><span class="line">0x0000000000400fcd &lt;+138&gt;:	retq  </span><br></pre></td></tr></table></figure>

<p>1、可以通过如下命令查看输入</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">(gdb)x/s 0x4025cf</span><br><span class="line">0x4025cf:	&quot;%d %d&quot;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>2、到了跳转命令后</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">jmpq   *0x402470(,%rax,8)</span><br></pre></td></tr></table></figure>

<p>3、查看该命令跳转到哪，以输入2为例子</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">(gdb) x *0x402480</span><br><span class="line">0x400f83 &lt;phase_3+64&gt;:	0x0002c3b8</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>4、跳转到+64的位置</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">0x0000000000400f83 &lt;+64&gt;:	mov    $0x2c3,%eax</span><br></pre></td></tr></table></figure>

<p>5、跳转到+123的位置进行比较</p>
<p>2 707</p>
<p>成功通过</p>
<h2 id="第四关"><a href="#第四关" class="headerlink" title="第四关"></a>第四关</h2><p>phase_4</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">0x000000000040100c &lt;+0&gt;:	sub    $0x18,%rsp</span><br><span class="line">   0x0000000000401010 &lt;+4&gt;:	lea    0xc(%rsp),%rcx  #a</span><br><span class="line">   0x0000000000401015 &lt;+9&gt;:	lea    0x8(%rsp),%rdx  #b</span><br><span class="line">   0x000000000040101a &lt;+14&gt;:	mov    $0x4025cf,%esi #x/s : &quot;%d %d&quot;</span><br><span class="line">   0x000000000040101f &lt;+19&gt;:	mov    $0x0,%eax</span><br><span class="line">   0x0000000000401024 &lt;+24&gt;:	callq  0x400bf0 &lt;__isoc99_sscanf@plt&gt;</span><br><span class="line">   0x0000000000401029 &lt;+29&gt;:	cmp    $0x2,%eax</span><br><span class="line">   0x000000000040102c &lt;+32&gt;:	jne    0x401035 &lt;phase_4+41&gt;</span><br><span class="line">   0x000000000040102e &lt;+34&gt;:	cmpl   $0xe,0x8(%rsp) </span><br><span class="line">   0x0000000000401033 &lt;+39&gt;:	jbe    0x40103a &lt;phase_4+46&gt;  #b&lt;=14</span><br><span class="line">   0x0000000000401035 &lt;+41&gt;:	callq  0x40143a &lt;explode_bomb&gt;</span><br><span class="line">   0x000000000040103a &lt;+46&gt;:	mov    $0xe,%edx #edx=14 ，关键参数</span><br><span class="line">   0x000000000040103f &lt;+51&gt;:	mov    $0x0,%esi #esi=0</span><br><span class="line">   0x0000000000401044 &lt;+56&gt;:	mov    0x8(%rsp),%edi #edi=b</span><br><span class="line">   0x0000000000401048 &lt;+60&gt;:	callq  0x400fce &lt;func4&gt;</span><br><span class="line">   0x000000000040104d &lt;+65&gt;:	test   %eax,%eax #最终的目的是让eax=0，所以找一个数让eax=0即可</span><br><span class="line">   0x000000000040104f &lt;+67&gt;:	jne    0x401058 &lt;phase_4+76&gt;</span><br><span class="line">   0x0000000000401051 &lt;+69&gt;:	cmpl   $0x0,0xc(%rsp) # 参数a只在这里用了一次，所以确定为0</span><br><span class="line">   0x0000000000401056 &lt;+74&gt;:	je     0x40105d &lt;phase_4+81&gt;</span><br><span class="line">   0x0000000000401058 &lt;+76&gt;:	callq  0x40143a &lt;explode_bomb&gt;</span><br><span class="line">   0x000000000040105d &lt;+81&gt;:	add    $0x18,%rsp</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>fun4 </p>
<p>（一个比较复杂的函数，但实际上是不用看的很详细的）</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">0x0000000000400fce &lt;+0&gt;:	sub    $0x8,%rsp</span><br><span class="line">0x0000000000400fd2 &lt;+4&gt;:	mov    %edx,%eax #eax=14    #</span><br><span class="line">0x0000000000400fd4 &lt;+6&gt;:	sub    %esi,%eax #eax=14-0  eax-esi=6  2 0</span><br><span class="line">0x0000000000400fd6 &lt;+8&gt;:	mov    %eax,%ecx #ecx=eax=14   eax=ecx=6  2 0</span><br><span class="line">0x0000000000400fd8 &lt;+10&gt;:	shr    $0x1f,%ecx #eck        #清0</span><br><span class="line">0x0000000000400fdb &lt;+13&gt;:	add    %ecx,%eax  #eax=14  6  2 0</span><br><span class="line">0x0000000000400fdd &lt;+15&gt;:	sar    %eax #eax/2  7  3   1  0   #/2的操作</span><br><span class="line">0x0000000000400fdf &lt;+17&gt;:	lea    (%rax,%rsi,1),%ecx  #ecx=7  rsi=0   11（3+8） 13(12+1)</span><br><span class="line">0x0000000000400fe2 &lt;+20&gt;:	cmp    %edi,%ecx #(14 7) (14,11)  </span><br><span class="line">0x0000000000400fe4 &lt;+22&gt;:	jle    0x400ff2 &lt;func4+36&gt; #jump    #小于等于</span><br><span class="line">0x0000000000400fe6 &lt;+24&gt;:	lea    -0x1(%rcx),%edx</span><br><span class="line">0x0000000000400fe9 &lt;+27&gt;:	callq  0x400fce &lt;func4&gt;</span><br><span class="line">0x0000000000400fee &lt;+32&gt;:	add    %eax,%eax</span><br><span class="line">0x0000000000400ff0 &lt;+34&gt;:	jmp    0x401007 &lt;func4+57&gt; #exit 2</span><br><span class="line">0x0000000000400ff2 &lt;+36&gt;:	mov    $0x0,%eax #eax=0   需要保留这个条件</span><br><span class="line">0x0000000000400ff7 &lt;+41&gt;:	cmp    %edi,%ecx #(14 7) (14,11) (14 13)</span><br><span class="line">0x0000000000400ff9 &lt;+43&gt;:	jge    0x401007 &lt;func4+57&gt;  ##3exit 1   #大于等于</span><br><span class="line">0x0000000000400ffb &lt;+45&gt;:	lea    0x1(%rcx),%esi #esi=8  12 14        ##不能进入这个,否则肯定不能=0</span><br><span class="line">0x0000000000400ffe &lt;+48&gt;:	callq  0x400fce &lt;func4&gt;</span><br><span class="line">0x0000000000401003 &lt;+53&gt;:	lea    0x1(%rax,%rax,1),%eax  #除非rax=0</span><br><span class="line">0x0000000000401007 &lt;+57&gt;:	add    $0x8,%rsp</span><br><span class="line">0x000000000040100b &lt;+61&gt;:	retq   </span><br><span class="line"></span><br></pre></td></tr></table></figure>



<p>可以发现，如果是临界值7，就可以直接跳出循环</p>
<p>7，0</p>
<h2 id="第五关"><a href="#第五关" class="headerlink" title="第五关"></a>第五关</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line">0x0000000000401062 &lt;+0&gt;:	push   %rbx</span><br><span class="line">0x0000000000401063 &lt;+1&gt;:	sub    $0x20,%rsp</span><br><span class="line">0x0000000000401067 &lt;+5&gt;:	mov    %rdi,%rbx</span><br><span class="line">0x000000000040106a &lt;+8&gt;:	mov    %fs:0x28,%rax  #栈溢出检测</span><br><span class="line">0x0000000000401073 &lt;+17&gt;:	mov    %rax,0x18(%rsp)</span><br><span class="line">0x0000000000401078 &lt;+22&gt;:	xor    %eax,%eax #清0</span><br><span class="line">0x000000000040107a &lt;+24&gt;:	callq  0x40131b &lt;string_length&gt;</span><br><span class="line">0x000000000040107f &lt;+29&gt;:	cmp    $0x6,%eax #输入长度为6的字符串--&gt;112</span><br><span class="line">0x0000000000401082 &lt;+32&gt;:	je     0x4010d2 &lt;phase_5+112&gt;</span><br><span class="line">0x0000000000401084 &lt;+34&gt;:	callq  0x40143a &lt;explode_bomb&gt;</span><br><span class="line">0x0000000000401089 &lt;+39&gt;:	jmp    0x4010d2 &lt;phase_5+112&gt;</span><br><span class="line">0x000000000040108b &lt;+41&gt;:	movzbl (%rbx,%rax,1),%ecx   #eax=0  ecx=97 (rbx)=A[1]</span><br><span class="line">0x000000000040108f &lt;+45&gt;:	mov    %cl,(%rsp)</span><br><span class="line">0x0000000000401092 &lt;+48&gt;:	mov    (%rsp),%rdx #</span><br><span class="line">0x0000000000401096 &lt;+52&gt;:	and    $0xf,%edx  #保留四位 rdx=1  3</span><br><span class="line">0x0000000000401099 &lt;+55&gt;:	movzbl 0x4024b0(%rdx),%edx #取低字节 ，从这个地址取字</span><br><span class="line">0x00000000004010a0 &lt;+62&gt;:	mov    %dl,0x10(%rsp,%rax,1)</span><br><span class="line">0x00000000004010a4 &lt;+66&gt;:	add    $0x1,%rax</span><br><span class="line">0x00000000004010a8 &lt;+70&gt;:	cmp    $0x6,%rax</span><br><span class="line">0x00000000004010ac &lt;+74&gt;:	jne    0x40108b &lt;phase_5+41&gt;</span><br><span class="line">0x00000000004010ae &lt;+76&gt;:	movb   $0x0,0x16(%rsp)</span><br><span class="line">0x00000000004010b3 &lt;+81&gt;:	mov    $0x40245e,%esi #  &quot;flyers&quot; 需要比较的字符串</span><br><span class="line">0x00000000004010b8 &lt;+86&gt;:	lea    0x10(%rsp),%rdi</span><br><span class="line">0x00000000004010bd &lt;+91&gt;:	callq  0x401338 &lt;strings_not_equal&gt;</span><br><span class="line">0x00000000004010c2 &lt;+96&gt;:	test   %eax,%eax</span><br><span class="line">0x00000000004010c4 &lt;+98&gt;:	je     0x4010d9 &lt;phase_5+119&gt;</span><br><span class="line">0x00000000004010c6 &lt;+100&gt;:	callq  0x40143a &lt;explode_bomb&gt;</span><br><span class="line">0x00000000004010cb &lt;+105&gt;:	nopl   0x0(%rax,%rax,1)</span><br><span class="line">0x00000000004010d0 &lt;+110&gt;:	jmp    0x4010d9 &lt;phase_5+119&gt;</span><br><span class="line">0x00000000004010d2 &lt;+112&gt;:	mov    $0x0,%eax</span><br><span class="line">0x00000000004010d7 &lt;+117&gt;:	jmp    0x40108b &lt;phase_5+41&gt;</span><br><span class="line">0x00000000004010d9 &lt;+119&gt;:	mov    0x18(%rsp),%rax</span><br><span class="line">0x00000000004010de &lt;+124&gt;:	xor    %fs:0x28,%rax</span><br><span class="line">0x00000000004010e7 &lt;+133&gt;:	je     0x4010ee &lt;phase_5+140&gt;0</span><br><span class="line">0x00000000004010e9 &lt;+135&gt;:	callq  0x400b30 &lt;__stack_chk_fail@plt&gt;</span><br><span class="line">0x00000000004010ee &lt;+140&gt;:	add    $0x20,%rsp</span><br><span class="line">0x00000000004010f2 &lt;+144&gt;:	pop    %rbx</span><br><span class="line">0x00000000004010f3 &lt;+145&gt;:	retq   </span><br></pre></td></tr></table></figure>

<p>前面是要将六个字符入栈</p>
<p>但并非输入的六个字符</p>
<p>可以发现是从如下地址取字</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">0x4024b0(%rdx),%edx #取低字节 </span><br></pre></td></tr></table></figure>

<p>输入如下指令得到</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">x 0x4024b0</span><br></pre></td></tr></table></figure>

<p>maduiersnfotvbyl</p>
<p>梳理代码逻辑可以发现是按照我们所输入字母的低4bit来定位的，如输入a=0x61,则定位 1 字符，恰巧也位a</p>
<p>所以如下</p>
<p>“flyers” = 9 f e 5 6 7</p>
<p>找几个字符后4bit与其相符：</p>
<p>ionefg</p>
<h2 id="第六关"><a href="#第六关" class="headerlink" title="第六关"></a>第六关</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br></pre></td><td class="code"><pre><span class="line">0x00000000004010f4 &lt;+0&gt;:	push   %r14</span><br><span class="line">0x00000000004010f6 &lt;+2&gt;:	push   %r13</span><br><span class="line">0x00000000004010f8 &lt;+4&gt;:	push   %r12</span><br><span class="line">0x00000000004010fa &lt;+6&gt;:	push   %rbp</span><br><span class="line">0x00000000004010fb &lt;+7&gt;:	push   %rbx #压栈</span><br><span class="line">0x00000000004010fc &lt;+8&gt;:	sub    $0x50,%rsp</span><br><span class="line">0x0000000000401100 &lt;+12&gt;:	mov    %rsp,%r13 #栈底</span><br><span class="line">0x0000000000401103 &lt;+15&gt;:	mov    %rsp,%rsi #栈底</span><br><span class="line">0x0000000000401106 &lt;+18&gt;:	callq  0x40145c &lt;read_six_numbers&gt; # ( 1,2,3,4,5,6 )</span><br><span class="line">0x000000000040110b &lt;+23&gt;:	mov    %rsp,%r14 #栈顶</span><br><span class="line">0x000000000040110e &lt;+26&gt;:	mov    $0x0,%r12 # r12=0</span><br><span class="line">0x0000000000401114 &lt;+32&gt;:	mov    %r13,%rbp #栈底 #r12即为当前数</span><br><span class="line">0x0000000000401117 &lt;+35&gt;:	mov    0x0(%r13),%eax #第一个数</span><br><span class="line">0x000000000040111b &lt;+39&gt;:	sub    $0x1,%eax # (6)-1</span><br><span class="line">0x000000000040111e &lt;+42&gt;:	cmp    $0x5,%eax # ()  第一个数为</span><br><span class="line">0x0000000000401121 &lt;+45&gt;:	jbe    0x401128 &lt;phase_6+52&gt; #&lt;=5 跳转 所以数应该为： 1 2 3 4 5 6之中，jbe为无符号数判断，所以不考虑0</span><br><span class="line">0x0000000000401123 &lt;+47&gt;:	callq  0x40143a &lt;explode_bomb&gt;</span><br><span class="line">0x0000000000401128 &lt;+52&gt;:	add    $0x1,%r12d #r12=1</span><br><span class="line">0x000000000040112c &lt;+56&gt;:	cmp    $0x6,%r12d #循环</span><br><span class="line">0x0000000000401130 &lt;+60&gt;:	je     0x401153 &lt;phase_6+95&gt;</span><br><span class="line">0x0000000000401132 &lt;+62&gt;:	mov    %r12d,%ebx #ebx=1</span><br><span class="line">0x0000000000401135 &lt;+65&gt;:	movslq %ebx,%rax  #rax=1</span><br><span class="line">0x0000000000401138 &lt;+68&gt;:	mov    (%rsp,%rax,4),%eax #eax=(rsp+4)</span><br><span class="line">0x000000000040113b &lt;+71&gt;:	cmp    %eax,0x0(%rbp) #第二个数和第一个数的关系为不相等，————所有数与第一个数不相等</span><br><span class="line">0x000000000040113e &lt;+74&gt;:	jne    0x401145 &lt;phase_6+81&gt;</span><br><span class="line">0x0000000000401140 &lt;+76&gt;:	callq  0x40143a &lt;explode_bomb&gt;</span><br><span class="line">0x0000000000401145 &lt;+81&gt;:	add    $0x1,%ebx #循环</span><br><span class="line">0x0000000000401148 &lt;+84&gt;:	cmp    $0x5,%ebx</span><br><span class="line">0x000000000040114b &lt;+87&gt;:	jle    0x401135 &lt;phase_6+65&gt;</span><br><span class="line">0x000000000040114d &lt;+89&gt;:	add    $0x4,%r13 #第二个数 #</span><br><span class="line">0x0000000000401151 &lt;+93&gt;:	jmp    0x401114 &lt;phase_6+32&gt;</span><br><span class="line">0x0000000000401153 &lt;+95&gt;:	lea    0x18(%rsp),%rsi # 0 </span><br><span class="line">0x0000000000401158 &lt;+100&gt;:	mov    %r14,%rax #rsp</span><br><span class="line">0x000000000040115b &lt;+103&gt;:	mov    $0x7,%ecx #ecx=7</span><br><span class="line">0x0000000000401160 &lt;+108&gt;:	mov    %ecx,%edx #edx=7</span><br><span class="line">0x0000000000401162 &lt;+110&gt;:	sub    (%rax),%edx #7-a() 7-输入的参数</span><br><span class="line">0x0000000000401164 &lt;+112&gt;:	mov    %edx,(%rax) #放到原来的位置，7-n  倒过来，比如</span><br><span class="line">0x0000000000401166 &lt;+114&gt;:	add    $0x4,%rax  #下一个</span><br><span class="line">0x000000000040116a &lt;+118&gt;:	cmp    %rsi,%rax  #到</span><br><span class="line">0x000000000040116d &lt;+121&gt;:	jne    0x401160 &lt;phase_6+108&gt;</span><br><span class="line">0x000000000040116f &lt;+123&gt;:	mov    $0x0,%esi #esi=0</span><br><span class="line">0x0000000000401174 &lt;+128&gt;:	jmp    0x401197 &lt;phase_6+163&gt; #jmp</span><br><span class="line">0x0000000000401176 &lt;+130&gt;:	mov    0x8(%rdx),%rdx #</span><br><span class="line">0x000000000040117a &lt;+134&gt;:	add    $0x1,%eax  #eax=2</span><br><span class="line">0x000000000040117d &lt;+137&gt;:	cmp    %ecx,%eax</span><br><span class="line">0x000000000040117f &lt;+139&gt;:	jne    0x401176 &lt;phase_6+130&gt;</span><br><span class="line">0x0000000000401181 &lt;+141&gt;:	jmp    0x401188 &lt;phase_6+148&gt;</span><br><span class="line">0x0000000000401183 &lt;+143&gt;:	mov    $0x6032d0,%edx</span><br><span class="line">0x0000000000401188 &lt;+148&gt;:	mov    %rdx,0x20(%rsp,%rsi,2) #rsp+20开始放入 0x6032d0+f*x,如果是6的话直接放如0x632d0</span><br><span class="line">0x000000000040118d &lt;+153&gt;:	add    $0x4,%rsi</span><br><span class="line">0x0000000000401191 &lt;+157&gt;:	cmp    $0x18,%rsi #6次</span><br><span class="line">0x0000000000401195 &lt;+161&gt;:	je     0x4011ab &lt;phase_6+183&gt;</span><br><span class="line">0x0000000000401197 &lt;+163&gt;:	mov    (%rsp,%rsi,1),%ecx #ecx=6</span><br><span class="line">0x000000000040119a &lt;+166&gt;:	cmp    $0x1,%ecx #每次取数要和1比</span><br><span class="line">0x000000000040119d &lt;+169&gt;:	jle    0x401183 &lt;phase_6+143&gt;</span><br><span class="line">0x000000000040119f &lt;+171&gt;:	mov    $0x1,%eax #eax=1</span><br><span class="line">0x00000000004011a4 &lt;+176&gt;:	mov    $0x6032d0,%edx  #第一个节点的位置</span><br><span class="line">0x00000000004011a9 &lt;+181&gt;:	jmp    0x401176 &lt;phase_6+130&gt;</span><br><span class="line">0x00000000004011ab &lt;+183&gt;:	mov    0x20(%rsp),%rbx  #rbx =第一个数的地址</span><br><span class="line">0x00000000004011b0 &lt;+188&gt;:	lea    0x28(%rsp),%rax  #rax =rsp+28</span><br><span class="line">0x00000000004011b5 &lt;+193&gt;:	lea    0x50(%rsp),%rsi  #rsp+50</span><br><span class="line">0x00000000004011ba &lt;+198&gt;:	mov    %rbx,%rcx  #</span><br><span class="line">0x00000000004011bd &lt;+201&gt;:	mov    (%rax),%rdx #rdx=第二个数的地址</span><br><span class="line">0x00000000004011c0 &lt;+204&gt;:	mov    %rdx,0x8(%rcx)  #建立链表，前8位为数字，后8为位下个的地址</span><br><span class="line">0x00000000004011c4 &lt;+208&gt;:	add    $0x8,%rax   </span><br><span class="line">0x00000000004011c8 &lt;+212&gt;:	cmp    %rsi,%rax</span><br><span class="line">0x00000000004011cb &lt;+215&gt;:	je     0x4011d2 &lt;phase_6+222&gt;</span><br><span class="line">0x00000000004011cd &lt;+217&gt;:	mov    %rdx,%rcx</span><br><span class="line">0x00000000004011d0 &lt;+220&gt;:	jmp    0x4011bd &lt;phase_6+201&gt;</span><br><span class="line">0x00000000004011d2 &lt;+222&gt;:	movq   $0x0,0x8(%rdx)# ----链表尾</span><br><span class="line">0x00000000004011da &lt;+230&gt;:	mov    $0x5,%ebp   #</span><br><span class="line">0x00000000004011df &lt;+235&gt;:	mov    0x8(%rbx),%rax</span><br><span class="line">0x00000000004011e3 &lt;+239&gt;:	mov    (%rax),%eax  </span><br><span class="line">0x00000000004011e5 &lt;+241&gt;:	cmp    %eax,(%rbx)   #</span><br><span class="line">0x00000000004011e7 &lt;+243&gt;:	jge    0x4011ee &lt;phase_6+250&gt;  #在下面的要比在上面的小才行！</span><br><span class="line">0x00000000004011e9 &lt;+245&gt;:	callq  0x40143a &lt;explode_bomb&gt;</span><br><span class="line">0x00000000004011ee &lt;+250&gt;:	mov    0x8(%rbx),%rbx</span><br><span class="line">0x00000000004011f2 &lt;+254&gt;:	sub    $0x1,%ebp</span><br><span class="line">0x00000000004011f5 &lt;+257&gt;:	jne    0x4011df &lt;phase_6+235&gt;</span><br><span class="line">0x00000000004011f7 &lt;+259&gt;:	add    $0x50,%rsp</span><br><span class="line">0x00000000004011fb &lt;+263&gt;:	pop    %rbx</span><br><span class="line">0x00000000004011fc &lt;+264&gt;:	pop    %rbp</span><br><span class="line">0x00000000004011fd &lt;+265&gt;:	pop    %r12</span><br><span class="line">0x00000000004011ff &lt;+267&gt;:	pop    %r13</span><br><span class="line">0x0000000000401201 &lt;+269&gt;:	pop    %r14</span><br><span class="line">0x0000000000401203 &lt;+271&gt;:	retq   </span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>过程：</p>
<p>1、首先输入六个数字，然后判断一下是否输入为小于等于6的数（+45）</p>
<p>2、判断是不是有重复的。(+71)</p>
<p>3、将输入的数用 7 减，放回原来位置，比如输入 6 5 4 3 2 1 就变成了 1 2 3 4 5 6  （+100 ~+128）</p>
<p>4、注意到一个特殊的立即数，$0x6032d0（+143  +176），用 x 0x6032d0查看，可以发现node1，之后每次+16，可以发现一个node数组，</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">(gdb) x $rbx</span><br><span class="line">0x603320 &lt;node6&gt;:	443</span><br><span class="line">(gdb) x $rbx-16</span><br><span class="line">0x603310 &lt;node5&gt;:	477</span><br><span class="line">(gdb) x $rbx-32</span><br><span class="line">0x603300 &lt;node4&gt;:	691</span><br><span class="line">(gdb) x $rbx-48</span><br><span class="line">0x6032f0 &lt;node3&gt;:	924</span><br><span class="line">(gdb) x $rbx-64</span><br><span class="line">0x6032e0 &lt;node2&gt;:	168</span><br><span class="line">(gdb) x $rbx-80</span><br><span class="line">0x6032d0 &lt;node1&gt;:	332</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>然后按照 （7-n）的顺序排列 从（rsp+0x20）开始，（+148）</p>
<p>比如目前顺序为6 5 4 3 2 1</p>
<p>则第一个数字6对应  332的位置=（rsp+0x20+6*8(一个数字占用的位置)）</p>
<p>相当于用输入的数字对node进行排序</p>
<p>5、建立链表    （+183~+222）</p>
<p>前面为数字，后面为下一个数字的地址（+204）</p>
<p>从rsp+20开始</p>
<p>6、通过链表比较大小 （+230~+257）</p>
<p>要求前面的要比后面的小  (+243)</p>
<p>7、自定义排序大小，然后用7减</p>
<p>答案为：4 3 2 1 6 5</p>
<h2 id="结语"><a href="#结语" class="headerlink" title="结语"></a>结语</h2><p>​    一阶段：大概用了一周的时间解完了，基本没遇到什么问题。但是实际上感觉基础知识并不扎实。明天过书吧，相信做完以后再过书，肯定会有不一样的收获.</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2022/01/22/bomblab/" data-id="ckyq0jwtl0000xoug9mdbdtyy" data-title="bomblab" class="article-share-link">Share</a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-CSAPP-LAB1" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2022/01/14/CSAPP-LAB1/" class="article-date">
  <time class="dt-published" datetime="2022-01-14T04:46:08.000Z" itemprop="datePublished">2022-01-14</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2022/01/14/CSAPP-LAB1/">CSAPP LAB1</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h1 id="CSAPP"><a href="#CSAPP" class="headerlink" title="CSAPP"></a>CSAPP</h1><h2 id="LAB1"><a href="#LAB1" class="headerlink" title="LAB1"></a>LAB1</h2><p>注：<strong>在Makefile中要把-m32改为-m64</strong></p>
<h3 id="1、bitAnd-int-int"><a href="#1、bitAnd-int-int" class="headerlink" title="1、bitAnd(int, int);"></a>1、bitAnd(int, int);</h3> <figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">bitAnd</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span> </span>&#123;</span><br><span class="line">  	<span class="keyword">unsigned</span> z;</span><br><span class="line">	z=~((~x)|(~y));</span><br><span class="line">	<span class="keyword">return</span> z;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="2、getByte-int-x-int-n"><a href="#2、getByte-int-x-int-n" class="headerlink" title="2、getByte(int x, int n)"></a>2、getByte(int x, int n)</h3><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"> * <span class="function"><span class="keyword">int</span> <span class="title">getByte</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> n)</span> </span>&#123;</span><br><span class="line">   <span class="keyword">return</span> (x &gt;&gt; (n &lt;&lt; <span class="number">3</span>)) &amp; <span class="number">0xFF</span> </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="3、logicalShift-int-x-int-n"><a href="#3、logicalShift-int-x-int-n" class="headerlink" title="3、logicalShift(int x, int n)"></a>3、logicalShift(int x, int n)</h3><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">logicalShift</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> n)</span> </span>&#123;</span><br><span class="line">	<span class="keyword">int</span> z=<span class="number">0x80000000</span>;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span> (n==<span class="number">0</span>)</span><br><span class="line">		<span class="keyword">return</span> x;</span><br><span class="line">	<span class="keyword">else</span></span><br><span class="line">  		<span class="keyword">return</span> (x&gt;&gt;n)&amp;(~(z&gt;&gt;(n<span class="number">-1</span>))); <span class="comment">//之前直接写0x80000000,结果不对，会把他看成无符号数进行逻辑右移，换为int以后就是算数右移了</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<hr>
<p>&lt;上述使用了禁止的符号  ‘ - ‘，数0x800000000,所以找方法把他们替换掉&gt;</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">logicalShift</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> n)</span> </span>&#123;</span><br><span class="line">	<span class="keyword">int</span> z=(<span class="number">0x1</span>&lt;&lt;<span class="number">31</span>);</span><br><span class="line">  	<span class="keyword">return</span> (x&gt;&gt;n)&amp;(~(z&gt;&gt;(n)&lt;&lt;<span class="number">1</span>));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h3 id="4、bitCount-int-x"><a href="#4、bitCount-int-x" class="headerlink" title="4、bitCount(int x)"></a>4、bitCount(int x)</h3><p>（1）、初次尝试</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">bitCount</span><span class="params">(<span class="keyword">int</span> x)</span> </span>&#123;</span><br><span class="line">	<span class="keyword">int</span> count=<span class="number">0</span>;</span><br><span class="line">	<span class="keyword">unsigned</span> z=x; <span class="comment">//禁止unsigned</span></span><br><span class="line">	<span class="keyword">while</span>(z!=<span class="number">0</span>)   <span class="comment">//禁止while</span></span><br><span class="line">		&#123;</span><br><span class="line">			count=count+(z&amp;<span class="number">0x1</span>);</span><br><span class="line">			z=z&gt;&gt;<span class="number">1</span>;</span><br><span class="line">		&#125;	</span><br><span class="line">  	<span class="keyword">return</span> count;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>(2)</p>
<h3 id="5、fitsBits-int-x-int-n"><a href="#5、fitsBits-int-x-int-n" class="headerlink" title="5、fitsBits(int x, int n)"></a>5、fitsBits(int x, int n)</h3><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* </span></span><br><span class="line"><span class="comment"> * fitsBits - return 1 if x can be represented as an </span></span><br><span class="line"><span class="comment"> *  n-bit, two&#x27;s complement integer.</span></span><br><span class="line"><span class="comment"> *   1 &lt;= n &lt;= 32</span></span><br><span class="line"><span class="comment"> *   Examples: fitsBits(5,3) = 0, fitsBits(-4,3) = 1</span></span><br><span class="line"><span class="comment"> *   Legal ops: ! ~ &amp; ^ | + &lt;&lt; &gt;&gt;</span></span><br><span class="line"><span class="comment"> *   Max ops: 15</span></span><br><span class="line"><span class="comment"> *   Rating: 2</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">fitsBits</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> n)</span> </span>&#123;</span><br><span class="line">	<span class="keyword">int</span> z=(<span class="number">0x1</span>&lt;&lt;<span class="number">31</span>)&gt;&gt;<span class="number">32</span>;  <span class="comment">//制早0xffffffff,也就是-1；；；； -1=~0....想复杂了</span></span><br><span class="line"> <span class="keyword">return</span> !((x&gt;&gt;(n+z))^(x&gt;&gt;<span class="number">31</span>));<span class="comment">//x右移n-1位，与符号位异或，再去！</span></span><br><span class="line">  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h3 id="6、negate-int-x"><a href="#6、negate-int-x" class="headerlink" title="6、negate(int x);"></a>6、negate(int x);</h3><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">negate</span><span class="params">(<span class="keyword">int</span> x)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> ~x+<span class="number">1</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h3 id="7、int-isPositive-int-x"><a href="#7、int-isPositive-int-x" class="headerlink" title="7、int isPositive(int x)"></a>7、int isPositive(int x)</h3><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* </span></span><br><span class="line"><span class="comment"> * isPositive - return 1 if x &gt; 0, return 0 otherwise </span></span><br><span class="line"><span class="comment"> *   Example: isPositive(-1) = 0.</span></span><br><span class="line"><span class="comment"> *   Legal ops: ! ~ &amp; ^ | + &lt;&lt; &gt;&gt;</span></span><br><span class="line"><span class="comment"> *   Max ops: 8</span></span><br><span class="line"><span class="comment"> *   Rating: 3</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">isPositive</span><span class="params">(<span class="keyword">int</span> x)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> (!x^!(x&gt;&gt;<span class="number">31</span>)); <span class="comment">// x&gt;&gt;31位即可判断正负，但是要考虑0的情况。用^去判断，如果是0，！0=1，！0（符号位）=1 ，1^1=0</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>8、int divpwr2(int x, int n) </p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* </span></span><br><span class="line"><span class="comment"> * divpwr2 - Compute x/(2^n), for 0 &lt;= n &lt;= 30</span></span><br><span class="line"><span class="comment"> *  Round 3b b /toward zero</span></span><br><span class="line"><span class="comment"> *   Examples: divpwr2(15,1) = 7, divpwr2(-33,4) = -2</span></span><br><span class="line"><span class="comment"> *   Legal ops: ! ~ &amp; ^ | + &lt;&lt; &gt;&gt;</span></span><br><span class="line"><span class="comment"> *   Max ops: 15</span></span><br><span class="line"><span class="comment"> *   Rating: 2</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">正数直接移</span></span><br><span class="line"><span class="comment">负数移动以后有的要+1</span></span><br><span class="line"><span class="comment">如果可以完全被二整除则不用，如果不能完全被二整除则需要。</span></span><br><span class="line"><span class="comment">可以想到判断移动后的，但是不方便</span></span><br><span class="line"><span class="comment">所以想到对原数进行处理</span></span><br><span class="line"><span class="comment">加一个偏移量(2^n-1)</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">divpwr2</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> n)</span> </span>&#123;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">int</span> flag=(x&gt;&gt;<span class="number">31</span>);<span class="comment">//符号</span></span><br><span class="line">	<span class="keyword">int</span> a =(<span class="number">0x1</span>&lt;&lt;n)+(~<span class="number">0</span>); <span class="comment">// 2^n-1;</span></span><br><span class="line">    	<span class="keyword">return</span> (x + (flag &amp; a) ) &gt;&gt; n ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h3 id="9、isLessOrEqual-int-x-int-y"><a href="#9、isLessOrEqual-int-x-int-y" class="headerlink" title="9、isLessOrEqual(int x, int y)"></a>9、isLessOrEqual(int x, int y)</h3><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* </span></span><br><span class="line"><span class="comment"> * isLessOrEqual - if x &lt;= y  then return 1, else return 0 </span></span><br><span class="line"><span class="comment"> *   Example: isLessOrEqual(4,5) = 1.</span></span><br><span class="line"><span class="comment"> *   Legal ops: ! ~ &amp; ^ | + &lt;&lt; &gt;&gt;</span></span><br><span class="line"><span class="comment"> *   Max ops: 24</span></span><br><span class="line"><span class="comment"> *   Rating: 3</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">很容易想到判断y-x的符号位，但是当两个数异号就会产生溢出的情况。</span></span><br><span class="line"><span class="comment">异号的话只用看x的符号就行</span></span><br><span class="line"><span class="comment">所以把两种情况分开讨论。</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">isLessOrEqual</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span> </span>&#123;</span><br><span class="line">	<span class="keyword">int</span> sign1=x&gt;&gt;<span class="number">31</span>&amp;<span class="number">0x1</span>;  <span class="comment">//x符号位</span></span><br><span class="line">	<span class="keyword">int</span> sign2=y&gt;&gt;<span class="number">31</span>&amp;<span class="number">0x1</span>;  <span class="comment">//y符号位</span></span><br><span class="line">	</span><br><span class="line">	<span class="keyword">int</span> z=y+(~x+<span class="number">1</span>);     <span class="comment">//z=y-x</span></span><br><span class="line">  <span class="keyword">return</span> (( !((z&gt;&gt;<span class="number">31</span>)&amp;<span class="number">0x1</span>) &amp; (  !(sign1^sign2)  ) ) ) |  ( (sign1^sign2)&amp;sign1 );</span><br><span class="line">    <span class="comment">//          判断z的符号           同号             |         异号     x的符号</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>





<h3 id="10、ilog2-int-x-（不会）"><a href="#10、ilog2-int-x-（不会）" class="headerlink" title="10、ilog2(int x)   （不会）"></a>10、ilog2(int x)   （不会）</h3><pre><code> （1、只能检测一位的方法......）
</code></pre>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> * ilog2 - return floor(log base 2 of x), where x &gt; 0</span></span><br><span class="line"><span class="comment"> *   Example: ilog2(16) = 4</span></span><br><span class="line"><span class="comment"> *s    Max ops: 90</span></span><br><span class="line"><span class="comment"> *   Rating: 4</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">ilog2</span><span class="params">(<span class="keyword">int</span> x)</span> </span>&#123;</span><br><span class="line">	<span class="keyword">int</span> seg1=x&gt;&gt;<span class="number">24</span>&amp;<span class="number">0xff</span>;</span><br><span class="line">	<span class="keyword">int</span> seg1_f=!!seg1;</span><br><span class="line">	<span class="keyword">int</span> seg2=x&gt;&gt;<span class="number">16</span>&amp;<span class="number">0xff</span>;</span><br><span class="line">	<span class="keyword">int</span> seg2_f=!!seg2;</span><br><span class="line">	<span class="keyword">int</span> seg3=x&gt;&gt;<span class="number">8</span>&amp;<span class="number">0xff</span>;</span><br><span class="line">	<span class="keyword">int</span> seg3_f=!!seg3;</span><br><span class="line">	<span class="keyword">int</span> seg4=x&amp;<span class="number">0xff</span>;</span><br><span class="line">	<span class="keyword">int</span> seg4_f=!!seg4;</span><br><span class="line">	<span class="keyword">int</span> res=seg1^seg2^seg3^seg4;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">int</span> res_s1=res&gt;&gt;<span class="number">4</span>&amp;<span class="number">0xf</span>;</span><br><span class="line">	<span class="keyword">int</span> res_s1_f=!!res_s1;</span><br><span class="line">	<span class="keyword">int</span> res_s2=res&amp;<span class="number">0xf</span>;</span><br><span class="line">	<span class="keyword">int</span> res_s2_f=!!res_s2;</span><br><span class="line">	<span class="keyword">int</span> res2=res_s1^res_s2;<span class="comment">//4</span></span><br><span class="line"></span><br><span class="line">	<span class="keyword">int</span> res2_s1=res2&gt;&gt;<span class="number">2</span>&amp;<span class="number">0x3</span>;</span><br><span class="line">	<span class="keyword">int</span> res2_s1_f=!!res2_s1;</span><br><span class="line">	<span class="keyword">int</span> res2_s2=res2&amp;<span class="number">0x3</span>;</span><br><span class="line">	<span class="keyword">int</span> res2_s2_f=!!res2_s2;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">int</span> res3=res2_s1^res_s2;<span class="comment">//2</span></span><br><span class="line"></span><br><span class="line">	<span class="keyword">int</span> sta=res3<span class="number">-1</span>;<span class="comment">//first or second</span></span><br><span class="line">	</span><br><span class="line">	<span class="keyword">int</span> count1=((<span class="number">2</span>+sta)&amp;~(res2_s1_f<span class="number">-1</span>))+((<span class="number">0</span>+sta)&amp;~(res2_s2_f<span class="number">-1</span>));</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">int</span> count2=((<span class="number">4</span>+count1)&amp;~(res_s1_f<span class="number">-1</span>))+((<span class="number">0</span>+count1)&amp;~(res_s2_f<span class="number">-1</span>));</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">int</span> count3=((<span class="number">24</span>+count2)&amp;~(seg1_f<span class="number">-1</span>))+((<span class="number">16</span>+count2)&amp;~(seg2_f<span class="number">-1</span>))+((<span class="number">8</span>+count2)&amp;~(seg3_f<span class="number">-1</span>))+((<span class="number">0</span>+count2)&amp;~(seg4_f<span class="number">-1</span>));</span><br><span class="line">	</span><br></pre></td></tr></table></figure>





<h3 id="11、float-i2f-int-x-（int-转float）"><a href="#11、float-i2f-int-x-（int-转float）" class="headerlink" title="11、float_i2f(int x)   （int 转float）"></a>11、float_i2f(int x)   （int 转float）</h3><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* </span></span><br><span class="line"><span class="comment"> * float_i2f - Return bit-level equivalent of expression (float) x</span></span><br><span class="line"><span class="comment"> *   Result is returned as unsigned int, but</span></span><br><span class="line"><span class="comment"> *   it is to be interpreted as the bit-level representation of a</span></span><br><span class="line"><span class="comment"> *   single-precision floating point values.</span></span><br><span class="line"><span class="comment"> *   Legal ops: Any integer/unsigned operations incl. ||, &amp;&amp;. also if, while</span></span><br><span class="line"><span class="comment"> *   Max ops: 30</span></span><br><span class="line"><span class="comment"> *   Rating: 4</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">unsigned</span> <span class="title">float_i2f</span><span class="params">(<span class="keyword">int</span> x)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span>(x == <span class="number">0</span>) </span><br><span class="line">		<span class="keyword">return</span> x;</span><br><span class="line">	<span class="keyword">if</span>(x == <span class="number">0x80000000</span>) <span class="comment">//min单独考虑</span></span><br><span class="line">		<span class="keyword">return</span> <span class="number">0xcf000000</span>;</span><br><span class="line">  	<span class="keyword">int</span> sign=x&gt;&gt;<span class="number">31</span>&amp;<span class="number">0x1</span>; <span class="comment">//符号位</span></span><br><span class="line">	<span class="keyword">int</span> temp=x;         <span class="comment">//</span></span><br><span class="line">	<span class="keyword">int</span> E=<span class="number">0</span>; 		   <span class="comment">//阶码</span></span><br><span class="line">	<span class="keyword">int</span> tail=<span class="number">0</span>;         <span class="comment">//尾数</span></span><br><span class="line">  	<span class="keyword">if</span>(x&lt;<span class="number">0</span>)</span><br><span class="line">		temp=~x+<span class="number">1</span>;		<span class="comment">//如果是负数，就取反加一（不考虑符号位）</span></span><br><span class="line">	<span class="keyword">int</span> rel=temp;</span><br><span class="line">	<span class="keyword">while</span>(!!(temp&gt;&gt;<span class="number">1</span>))   <span class="comment">//求阶码</span></span><br><span class="line">		&#123;</span><br><span class="line">			E++;</span><br><span class="line">			temp=temp&gt;&gt;<span class="number">1</span>;</span><br><span class="line">		&#125;</span><br><span class="line">	</span><br><span class="line">	tail = ((rel &lt;&lt; (<span class="number">32</span> - E)) &gt;&gt; <span class="number">9</span>) &amp; <span class="number">0x7fffff</span>;  <span class="comment">//算尾数</span></span><br><span class="line">	<span class="keyword">int</span> flag = (rel &lt;&lt; (<span class="number">32</span> - E)) &amp; <span class="number">0x1ff</span>;<span class="comment">//要被移出去的部分</span></span><br><span class="line">	<span class="keyword">int</span> jinwei = (flag &gt; <span class="number">256</span>) || ((flag == <span class="number">256</span>) &amp;&amp; (tail &amp; <span class="number">1</span>));<span class="comment">//如果&gt;256,说明最后一位是1，一定要进位，=256就要看尾数															末尾</span></span><br><span class="line">	E = E + <span class="number">127</span>;</span><br><span class="line">	tail = tail + jinwei;				<span class="comment">//进位</span></span><br><span class="line">	</span><br><span class="line">	<span class="keyword">if</span>(tail &gt;&gt; <span class="number">23</span>)   <span class="comment">//如果溢出，则E+1</span></span><br><span class="line">    	&#123;</span><br><span class="line">        tail = tail &amp;<span class="number">0x007FFFFF</span>;</span><br><span class="line">        E+=<span class="number">1</span>;  </span><br><span class="line">    	&#125;</span><br><span class="line">	<span class="keyword">unsigned</span> result = (sign &lt;&lt; <span class="number">31</span>) | (E &lt;&lt; <span class="number">23</span>) | (tail &amp; <span class="number">0x7fffff</span>); <span class="comment">//拼接</span></span><br><span class="line">	<span class="number">0.</span></span><br><span class="line">	</span><br><span class="line">	</span><br><span class="line">  	<span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h3 id="12、float-twice-unsigned-uf"><a href="#12、float-twice-unsigned-uf" class="headerlink" title="12、float_twice(unsigned uf)"></a>12、float_twice(unsigned uf)</h3><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* </span></span><br><span class="line"><span class="comment"> * float_twice - Return bit-level equivalent of expression 2*f for</span></span><br><span class="line"><span class="comment"> *   floating point argument f.</span></span><br><span class="line"><span class="comment"> *   Both the argument and result are passed as unsigned int&#x27;s, but</span></span><br><span class="line"><span class="comment"> *   they are to be interpreted as the bit-level representation of</span></span><br><span class="line"><span class="comment"> *   single-precision floating point values.</span></span><br><span class="line"><span class="comment"> *   When argument is NaN, return argument</span></span><br><span class="line"><span class="comment"> *   Legal ops: Any integer/unsigned operations incl. ||, &amp;&amp;. also if, while</span></span><br><span class="line"><span class="comment"> *   Max ops: 30</span></span><br><span class="line"><span class="comment"> *   Rating: 4</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">unsigned</span> <span class="title">float_twice</span><span class="params">(<span class="keyword">unsigned</span> uf)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span>(((uf&lt;&lt;<span class="number">1</span>)&amp;<span class="number">0xff000000</span>)==<span class="number">0xff000000</span>) <span class="comment">//NAN</span></span><br><span class="line">	<span class="keyword">return</span> uf;</span><br><span class="line">  <span class="keyword">if</span> (uf==<span class="number">0</span>)  <span class="comment">//0</span></span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">if</span>(uf == <span class="number">0x80000000</span>) <span class="comment">//min</span></span><br><span class="line">	<span class="keyword">return</span> <span class="number">0x80000000</span>;</span><br><span class="line">  <span class="keyword">unsigned</span> E=uf&gt;&gt;<span class="number">23</span>&amp;<span class="number">0xff</span>;</span><br><span class="line">  <span class="keyword">unsigned</span> M=uf&amp;<span class="number">0x007FFFFF</span>;</span><br><span class="line">  <span class="keyword">unsigned</span> result;</span><br><span class="line">  <span class="keyword">unsigned</span> New_E=E+<span class="number">1</span>;</span><br><span class="line">  <span class="keyword">if</span>(E!=<span class="number">0</span>)  </span><br><span class="line">	&#123;</span><br><span class="line">	result=(uf&amp;<span class="number">0x807fffff</span>)|(New_E&lt;&lt;<span class="number">23</span>);  <span class="comment">//阶码+1</span></span><br><span class="line">	&#125;</span><br><span class="line">  <span class="keyword">else</span> <span class="keyword">if</span>(M!=<span class="number">0</span>)</span><br><span class="line">	result=uf&amp;<span class="number">0xff800000</span>|(M&lt;&lt;<span class="number">1</span>);  <span class="comment">//E=0时候，只要尾数*2即可</span></span><br><span class="line">  </span><br><span class="line">  </span><br><span class="line"></span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2022/01/14/CSAPP-LAB1/" data-id="ckydx5azl0000owug7xpufqch" data-title="CSAPP LAB1" class="article-share-link">Share</a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-hello-world" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2021/12/28/hello-world/" class="article-date">
  <time class="dt-published" datetime="2021-12-28T08:32:41.247Z" itemprop="datePublished">2021-12-28</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2021/12/28/hello-world/">Hello World</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p>Welcome to <a target="_blank" rel="noopener" href="https://hexo.io/">Hexo</a>! This is your very first post. Check <a target="_blank" rel="noopener" href="https://hexo.io/docs/">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a target="_blank" rel="noopener" href="https://hexo.io/docs/troubleshooting.html">troubleshooting</a> or you can ask me on <a target="_blank" rel="noopener" href="https://github.com/hexojs/hexo/issues">GitHub</a>.</p>
<h2 id="Quick-Start"><a href="#Quick-Start" class="headerlink" title="Quick Start"></a>Quick Start</h2><h3 id="Create-a-new-post"><a href="#Create-a-new-post" class="headerlink" title="Create a new post"></a>Create a new post</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo new <span class="string">&quot;My New Post&quot;</span></span><br></pre></td></tr></table></figure>

<p>More info: <a target="_blank" rel="noopener" href="https://hexo.io/docs/writing.html">Writing</a></p>
<h3 id="Run-server"><a href="#Run-server" class="headerlink" title="Run server"></a>Run server</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo server</span><br></pre></td></tr></table></figure>

<p>More info: <a target="_blank" rel="noopener" href="https://hexo.io/docs/server.html">Server</a></p>
<h3 id="Generate-static-files"><a href="#Generate-static-files" class="headerlink" title="Generate static files"></a>Generate static files</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo generate</span><br></pre></td></tr></table></figure>

<p>More info: <a target="_blank" rel="noopener" href="https://hexo.io/docs/generating.html">Generating</a></p>
<h3 id="Deploy-to-remote-sites"><a href="#Deploy-to-remote-sites" class="headerlink" title="Deploy to remote sites"></a>Deploy to remote sites</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo deploy</span><br></pre></td></tr></table></figure>

<p>More info: <a target="_blank" rel="noopener" href="https://hexo.io/docs/one-command-deployment.html">Deployment</a></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2021/12/28/hello-world/" data-id="cky9tmnx30000l0ug0yr35dia" data-title="Hello World" class="article-share-link">Share</a>
      
      
      
    </footer>
  </div>
  
</article>



  


</section>
        
          <aside id="sidebar">
  
    

  
    

  
    
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/02/">February 2022</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/01/">January 2022</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/12/">December 2021</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2022/02/23/CacheLab/">(no title)</a>
          </li>
        
          <li>
            <a href="/2022/02/23/Docker%20%E4%BB%8E%E5%85%A5%E9%97%A8%E5%88%B0%E5%85%A5%E5%9C%9F/">(no title)</a>
          </li>
        
          <li>
            <a href="/2022/02/06/Lab3%20Buffer%20lab/">(no title)</a>
          </li>
        
          <li>
            <a href="/2022/01/22/bomblab/">bomblab</a>
          </li>
        
          <li>
            <a href="/2022/01/14/CSAPP-LAB1/">CSAPP LAB1</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      
      &copy; 2022 John Doe<br>
      Powered by <a href="https://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>

    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    


<script src="/js/jquery-3.4.1.min.js"></script>



  
<script src="/fancybox/jquery.fancybox.min.js"></script>




<script src="/js/script.js"></script>





  </div>
</body>
</html>