<!DOCTYPE html>

<html lang="zh-CN">

<head>
    
    <title>昨夜星辰恰似你</title>
    <meta charset="UTF-8">
    <meta name="keywords" content="">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=5">
    
    

    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon" />
    <meta name="description" content="cCacheLab前期准备 评分标准 相关ppt  安装valgrind内存泄露检测工具。1sudo apt install valgrind  相关参数1、         输入模式1234I 0400d7d4,8M 0421c7f0,4L 04f6b868,8S 7ff0005c8,8  The operation field denotes the type of memory access">
<meta property="og:type" content="article">
<meta property="og:title" content="昨夜星辰恰似你">
<meta property="og:url" content="https://yuzi2233.github.io/2022/02/23/CacheLab/index.html">
<meta property="og:site_name" content="昨夜星辰恰似你">
<meta property="og:description" content="cCacheLab前期准备 评分标准 相关ppt  安装valgrind内存泄露检测工具。1sudo apt install valgrind  相关参数1、         输入模式1234I 0400d7d4,8M 0421c7f0,4L 04f6b868,8S 7ff0005c8,8  The operation field denotes the type of memory access">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="c:\Users\DELL\AppData\Roaming\Typora\typora-user-images\image-20220227165149385.png">
<meta property="og:image" content="c:\Users\DELL\AppData\Roaming\Typora\typora-user-images\image-20220227165226934.png">
<meta property="og:image" content="c:\Users\DELL\AppData\Roaming\Typora\typora-user-images\image-20220227171640249.png">
<meta property="og:image" content="c:\Users\DELL\AppData\Roaming\Typora\typora-user-images\image-20220228145950516.png">
<meta property="og:image" content="c:\Users\DELL\AppData\Roaming\Typora\typora-user-images\image-20220302130034008.png">
<meta property="og:image" content="c:\Users\DELL\AppData\Roaming\Typora\typora-user-images\image-20220302130050907.png">
<meta property="article:published_time" content="2022-02-23T14:10:28.433Z">
<meta property="article:modified_time" content="2022-03-02T06:18:44.670Z">
<meta property="article:author" content="GuoYu_LLR">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="c:\Users\DELL\AppData\Roaming\Typora\typora-user-images\image-20220227165149385.png">
    
<link rel="stylesheet" href="/lib/fancybox/fancybox.css">
<link rel="stylesheet" href="/lib/justifiedGallery/justifiedGallery.min.css">
<link rel="stylesheet" href="/lib/mdui_043tiny/mdui.css">


    <link rel="stylesheet" href="/lib/iconfont/iconfont.css?v=1676628166822">
    
    <link rel="stylesheet" href="/css/style.css?v=1676628166822">
    
<meta name="generator" content="Hexo 6.3.0"></head>

<body class="mdui-drawer-body-left">
    
    <div id="nexmoe-background">
        <div class="nexmoe-bg" style="background-image: url(https://cdn.jsdelivr.net/gh/nexmoe/nexmoe.github.io@latest/images/cover/5c3aec85a4343.jpg)"></div>
        <div class="mdui-appbar mdui-shadow-0">
            <div class="mdui-toolbar">
                <a mdui-drawer="{target: '#drawer', swipe: true}" title="menu" class="mdui-btn mdui-btn-icon mdui-ripple"><i class="mdui-icon nexmoefont icon-menu"></i></a>
                <div class="mdui-toolbar-spacer"></div>
                <!--<a href="javascript:;" class="mdui-btn mdui-btn-icon"><i class="mdui-icon material-icons">search</i></a>-->
                <a href="/" title="GuoYu_LLR" class="mdui-btn mdui-btn-icon"><img src="https://cdn.jsdelivr.net/gh/nexmoe/nexmoe.github.io@latest/images/avatar.png" alt="GuoYu_LLR"></a>
            </div>
        </div>
    </div>
    <div id="nexmoe-header">
        <div class="nexmoe-drawer mdui-drawer" id="drawer">
    <div class="nexmoe-avatar mdui-ripple">
        <a href="/" title="GuoYu_LLR">
            <img src="https://cdn.jsdelivr.net/gh/nexmoe/nexmoe.github.io@latest/images/avatar.png" alt="GuoYu_LLR" alt="GuoYu_LLR">
        </a>
    </div>
    <div class="nexmoe-count">
        <div><span>文章</span>23</div>
        <div><span>标签</span>0</div>
        <div><span>分类</span>2</div>
    </div>
    <div class="nexmoe-list mdui-list" mdui-collapse="{accordion: true}">
        
        <a class="nexmoe-list-item mdui-list-item mdui-ripple false" href="/" title="回到首页">
            <i class="mdui-list-item-icon nexmoefont icon-home"></i>
            <div class="mdui-list-item-content">
                回到首页
            </div>
        </a>
        
        <a class="nexmoe-list-item mdui-list-item mdui-ripple false" href="/about.html" title="关于博客">
            <i class="mdui-list-item-icon nexmoefont icon-info-circle"></i>
            <div class="mdui-list-item-content">
                关于博客
            </div>
        </a>
        
        <a class="nexmoe-list-item mdui-list-item mdui-ripple false" href="/PY.html" title="我的朋友">
            <i class="mdui-list-item-icon nexmoefont icon-unorderedlist"></i>
            <div class="mdui-list-item-content">
                我的朋友
            </div>
        </a>
        
    </div>
    <aside id="nexmoe-sidebar">
    
    <div class="nexmoe-widget-wrap">
    <div class="nexmoe-widget nexmoe-search">
         
            <form id="search_form" action_e="https://cn.bing.com/search?q=site:nexmoe.com" onsubmit="return search();">
                <label><input id="search_value" name="q" type="search" placeholder="搜索"></label>
            </form>
         
    </div>
</div>
    
    <div class="nexmoe-widget-wrap">
    <div class="nexmoe-widget nexmoe-social">
        <a class="mdui-ripple" href="https://jq.qq.com/?_wv=1027&k=5CfKHun" target="_blank" mdui-tooltip="{content: 'QQ群'}" style="color: rgb(249, 174, 8);background-color: rgba(249, 174, 8, .1);">
            <i class="nexmoefont icon-QQ"></i>
        </a><a class="mdui-ripple" href="https://space.bilibili.com/20238211" target="_blank" mdui-tooltip="{content: '哔哩哔哩'}" style="color: rgb(231, 106, 141);background-color: rgba(231, 106, 141, .15);">
            <i class="nexmoefont icon-bilibili"></i>
        </a><a class="mdui-ripple" href="https://github.com/nexmoe/" target="_blank" mdui-tooltip="{content: 'GitHub'}" style="color: rgb(25, 23, 23);background-color: rgba(25, 23, 23, .15);">
            <i class="nexmoefont icon-github"></i>
        </a>
    </div>
</div>
    
    
  <div class="nexmoe-widget-wrap">
    <h3 class="nexmoe-widget-title">文章分类</h3>
    <div class="nexmoe-widget">

      <ul class="category-list">

        


        

        

        <li class="category-list-item">
          <a class="category-list-link" href="/categories/Algorithms/">Algorithms</a>
          <span class="category-list-count">2</span>
        </li>

        

        <li class="category-list-item">
          <a class="category-list-link" href="/categories/Study/">Study</a>
          <span class="category-list-count">2</span>
        </li>

        
      </ul>

    </div>
  </div>


    
    
    
    <!-- 一言 -->

  <div class="nexmoe-widget-wrap">
    <h3 class="nexmoe-widget-title">
      一言
    </h3>
    <div class="nexmoe-widget">
      <ul class="hitokoto-box">
        <li id="hitokoto_text_parent" class="hitokoto-text" hitokotoCategory="">
          <a href="#" id="hitokoto_text">
            
          </a>
          <a href="#" id="hitokoto_error_text" style="display: none;">
            
          </a>
        </li>
      </ul>
    </div>
  </div>

  <script>
    let hitokotoText = document.getElementById('hitokoto_text')
    let hitokotoErroText = document.getElementById('hitokoto_error_text')
    let hitokotoCategory = document.getElementById('hitokoto_text_parent').getAttribute('hitokotoCategory')
    window.onload = function () {
      let url = 'https://v1.hitokoto.cn'
      if (hitokotoCategory) {
        url += '?c=' + hitokotoCategory
      }
      fetch(url)
        .then(response => response.json())
        .then(data => {
          hitokotoText.innerText = "「 " + data.hitokoto + " 」 from " + data.from
          hitokotoText.href = 'https://hitokoto.cn/?uuid=' + data.uuid
        })
        .catch((reason) => {
          console.error(11, reason)
          hitokotoText.style.display = 'none'
          hitokotoErroText.style.display = 'block'
        })
    }
  </script>
  
    
</aside>
    <div class="nexmoe-copyright">
        &copy; 2023 GuoYu_LLR
        Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
        & <a href="https://github.com/theme-nexmoe/hexo-theme-nexmoe" target="_blank">Nexmoe</a>
        <br><a target="_blank" href="https://www.upyun.com/?utm_source=lianmeng&utm_medium=referral"><img src="https://i.dawnlab.me/c0268c1e6cfd0863d6ba35be1575941a.png" width="150px"></a><script data-ad-client="ca-pub-2058306854838448" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
    </div>
</div><!-- .nexmoe-drawer -->
    </div>
    <div id="nexmoe-content">
        <div class="nexmoe-primary">
            <div class="nexmoe-post">

  <article>
      
          <div class="nexmoe-post-cover" style="padding-bottom: 66.66666666666666%;"> 
              <img data-fancybox="gallery" src="https://cdn.jsdelivr.net/gh/nexmoe/nexmoe.github.io@latest/images/cover/5c3aec85a4343.jpg" alt="" loading="lazy">
              <h1></h1>
          </div>
      
      
      <div class="nexmoe-post-meta nexmoe-rainbow" style="margin:10px 0!important;">
    <a><i class="nexmoefont icon-calendar-fill"></i>2022年02月23日</a>
</div>

      <div class="nexmoe-post-meta nexmoe-rainbow" style="margin:10px 0!important;">
    
        <a><i class="nexmoefont icon-areachart"></i>约3k字</a>
        <a><i class="nexmoefont icon-time-circle-fill"></i>预计需要16分钟</a>
    
</div>

      <h1 id="cCacheLab"><a href="#cCacheLab" class="headerlink" title="cCacheLab"></a>cCacheLab</h1><h2 id="前期准备"><a href="#前期准备" class="headerlink" title="前期准备"></a>前期准备</h2><blockquote>
<p><a target="_blank" rel="noopener" href="http://www.cs.cmu.edu/afs/cs/academic/class/15213-f15/www/recitations/rec07.pdf">评分标准</a></p>
<p><a target="_blank" rel="noopener" href="http://www.cs.cmu.edu/afs/cs/academic/class/15213-f15/www/recitations/rec07.pdf">相关ppt</a></p>
</blockquote>
<h3 id="安装valgrind内存泄露检测工具。"><a href="#安装valgrind内存泄露检测工具。" class="headerlink" title="安装valgrind内存泄露检测工具。"></a>安装valgrind内存泄露检测工具。</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo apt install valgrind</span><br></pre></td></tr></table></figure>

<h3 id="相关参数"><a href="#相关参数" class="headerlink" title="相关参数"></a>相关参数</h3><p>1、</p>
<img data-fancybox="gallery" src="C:\Users\DELL\AppData\Roaming\Typora\typora-user-images\image-20220227165149385.png" alt="图片" data-caption="图片" loading="lazy">



<img data-fancybox="gallery" src="C:\Users\DELL\AppData\Roaming\Typora\typora-user-images\image-20220227165226934.png" alt="结构层次" data-caption="结构层次" loading="lazy">



<h3 id="输入模式"><a href="#输入模式" class="headerlink" title="输入模式"></a>输入模式</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">I 0400d7d4,8</span><br><span class="line">M 0421c7f0,4</span><br><span class="line">L 04f6b868,8</span><br><span class="line">S 7ff0005c8,8</span><br></pre></td></tr></table></figure>

<p>The operation field denotes the type of memory access: “I” denotes an instruction load, “L” a data load, “S” a data store, and “M” a data modify (i.e., a data load followed by a data store). There is never a space before each “I”. There is always a space before each “M”, “L”, and “S”. The address field specifies a 64-bit hexadecimal memory address. The size field specifies the number of bytes accessed by the operation.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">Usage: ./csim-ref [-hv] -s &lt;s&gt; -E &lt;E&gt; -b &lt;b&gt; -t &lt;tracefile&gt;</span><br><span class="line">• -h: Optional help flag that prints usage info</span><br><span class="line">• -v: Optional verbose flag that displays trace info</span><br><span class="line">• -s &lt;s&gt;: Number of set index bits (S = 2^s is the number of sets)</span><br><span class="line">• -E &lt;E&gt;: Associativity (number of lines per set)</span><br><span class="line">• -b &lt;b&gt;: Number of block bits (B = 2^b is the block size)</span><br><span class="line">• -t &lt;tracefile&gt;: Name of the valgrind trace to replay</span><br></pre></td></tr></table></figure>

<p> 分析：</p>
<p>​        I 、M 、L 、S  为操作模式，I 为取指令，在本次lab里可以忽略；M 为修改，先取后存；L 为 load ；S 为store</p>
<p>​        地址为最重要的参数，需要根据输入的  <code>S</code>  <code>E</code> <code>B</code> 来确定，采取组相联的模式</p>
<p>​        地址分解函数如下：</p>
 <figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">Split</span><span class="params">(<span class="type">unsigned</span> <span class="type">int</span> *address_c,<span class="type">unsigned</span> <span class="type">long</span> address)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">int</span> mask1=<span class="number">1</span>,mask2=<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;s<span class="number">-1</span>;i++)</span><br><span class="line">    &#123;</span><br><span class="line">        mask1=mask1&lt;&lt;<span class="number">1</span>;</span><br><span class="line">        mask1=mask1|<span class="number">0x1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;s+b<span class="number">-1</span>;i++)</span><br><span class="line">    &#123;</span><br><span class="line">        mask2=mask2&lt;&lt;<span class="number">1</span>;</span><br><span class="line">        mask2=mask2|<span class="number">0x1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    address_c[<span class="number">0</span>]=<span class="number">0</span>; <span class="comment">//偏移量</span></span><br><span class="line">    address_c[<span class="number">1</span>]=(address&gt;&gt;b)&amp;(mask1); <span class="comment">//组号</span></span><br><span class="line">    address_c[<span class="number">2</span>]=((address&gt;&gt;(b+s)));   <span class="comment">//标志位</span></span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h3 id="调试方法"><a href="#调试方法" class="headerlink" title="调试方法"></a>调试方法</h3><p> 1、标准测试</p>
 <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./test-csim</span><br></pre></td></tr></table></figure>

<p>2、标准cache测试</p>
 <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./csim-ref -v -s 2 -E 2 -b 3 -t traces/trans.trace</span><br></pre></td></tr></table></figure>

<p>3、自行测试</p>
 <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./csim -v -s 2 -E 2 -b 3 -t traces/trans.trace</span><br></pre></td></tr></table></figure>



<h2 id="代码与注释"><a href="#代码与注释" class="headerlink" title="代码与注释"></a>代码与注释</h2><h3 id="Lab-A"><a href="#Lab-A" class="headerlink" title="Lab A"></a>Lab A</h3><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;cachelab.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;stdio.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;getopt.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span>  <span class="string">&lt;unistd.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;string.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;stdlib.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;math.h&quot;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">const</span> <span class="type">char</span> *usage =<span class="string">&quot;Usage: ./csim-ref [-hv] -s &lt;s&gt; -E &lt;E&gt; -b &lt;b&gt; -t &lt;tracefile&gt;\n&quot;</span>;</span><br><span class="line"><span class="type">int</span> v,h,s,E,b,t,S;</span><br><span class="line"><span class="type">unsigned</span> <span class="type">int</span> mask1=<span class="number">1</span>,mask2=<span class="number">1</span>;</span><br><span class="line"><span class="type">int</span> hits=<span class="number">0</span>,misss=<span class="number">0</span>,evictions=<span class="number">0</span>;</span><br><span class="line"><span class="type">char</span> file[<span class="number">1000</span>];</span><br><span class="line"><span class="comment">//cache 采用二维动态数组建立</span></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Cache</span>    </span></span><br><span class="line"><span class="class">&#123;</span> </span><br><span class="line">    <span class="type">int</span> vaild; <span class="comment">//有效位 （未使用）</span></span><br><span class="line">    <span class="type">int</span> tag;   <span class="comment">//标志位</span></span><br><span class="line">    <span class="type">int</span> LRU_flag; <span class="comment">//LRU 标志位</span></span><br><span class="line">&#125;cache_block,*cache_set,**cache;  </span><br><span class="line"><span class="comment">//命中後，hits++，  更新LRU_flag</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">HIt</span><span class="params">(<span class="keyword">struct</span> Cache *cache_set,<span class="type">int</span> hit_num)</span></span><br><span class="line">&#123;</span><br><span class="line">    hits++;</span><br><span class="line">    <span class="keyword">if</span>(v==<span class="number">1</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot; hit&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;E;i++)</span><br><span class="line">    &#123;</span><br><span class="line">        cache_set[i].LRU_flag++;    <span class="comment">//采用位数法：命中或使用过的清0，未使用过的+1</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    cache_set[hit_num].LRU_flag=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//如果有空格，直接填入</span></span><br><span class="line"><span class="comment">//沒有則置換</span></span><br><span class="line"></span><br><span class="line"><span class="type">void</span>  <span class="title function_">Eviction</span><span class="params">(<span class="keyword">struct</span>  Cache *<span class="built_in">set</span>,<span class="type">int</span> tag)</span>  <span class="comment">//置换</span></span><br><span class="line">&#123;</span><br><span class="line">    evictions++;</span><br><span class="line">    <span class="keyword">if</span>(v==<span class="number">1</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot; eviction&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="type">int</span> max=<span class="number">0</span>,index=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;E;i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="built_in">set</span>[i].LRU_flag&gt;max)   <span class="comment">//置换最大的数</span></span><br><span class="line">        &#123;</span><br><span class="line">            max=<span class="built_in">set</span>[i].LRU_flag; </span><br><span class="line">            index=i;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">set</span>[i].LRU_flag++;      <span class="comment">//最开始将这句话遗忘了，置换以后也要将其他的+1；</span></span><br><span class="line">     &#125;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">set</span>[index].LRU_flag=<span class="number">0</span>;</span><br><span class="line">    <span class="built_in">set</span>[index].tag=tag;</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Miss</span><span class="params">(<span class="keyword">struct</span> Cache *<span class="built_in">set</span>,<span class="type">int</span> tag)</span></span><br><span class="line">&#123;</span><br><span class="line">    misss++;</span><br><span class="line">    <span class="keyword">if</span>(v==<span class="number">1</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot; miss&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;E;i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="built_in">set</span>[i].vaild==<span class="number">0</span>)    <span class="comment">//如果还有空闲块</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="built_in">set</span>[i].vaild=<span class="number">1</span>;</span><br><span class="line">            <span class="built_in">set</span>[i].tag=tag;</span><br><span class="line">            <span class="built_in">set</span>[i].LRU_flag=<span class="number">0</span>; <span class="comment">///未完成</span></span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">    Eviction(<span class="built_in">set</span>,tag);</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//寻找cache里面是否有对应的块</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">Search</span><span class="params">(<span class="type">unsigned</span> <span class="type">long</span> address,<span class="type">unsigned</span> <span class="type">int</span> *address_c)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">int</span> <span class="built_in">set</span>,flag;</span><br><span class="line">    <span class="built_in">set</span>=address_c[<span class="number">1</span>];</span><br><span class="line">    flag=address_c[<span class="number">2</span>];</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;E;i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span>(cache[<span class="built_in">set</span>][i].tag==flag)</span><br><span class="line">        &#123;</span><br><span class="line">            HIt(cache[<span class="built_in">set</span>],i);</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    Miss(cache[<span class="built_in">set</span>],address_c[<span class="number">2</span>]);</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//分解地址函数</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">Split</span><span class="params">(<span class="type">unsigned</span> <span class="type">int</span> *address_c,<span class="type">unsigned</span> <span class="type">long</span> address)</span></span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line">    address_c[<span class="number">0</span>]=<span class="number">0</span>;</span><br><span class="line">    address_c[<span class="number">1</span>]=(address&gt;&gt;b)&amp;(mask1);</span><br><span class="line">    address_c[<span class="number">2</span>]=((address&gt;&gt;(b+s)));</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">void</span> <span class="title function_">init_Cache</span><span class="params">(<span class="type">int</span> s, <span class="type">int</span> E,<span class="type">int</span> b)</span></span><br><span class="line">&#123;</span><br><span class="line">    cache=<span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(cache_set)*S);</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i =<span class="number">0</span> ; i &lt; S ; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        cache[i]=<span class="built_in">malloc</span>(<span class="keyword">sizeof</span> (cache_block)*E);</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> j=<span class="number">0</span>;j&lt;E;j++)</span><br><span class="line">        &#123;</span><br><span class="line">            cache[i][j].tag=<span class="number">-1</span>;</span><br><span class="line">            cache[i][j].LRU_flag=<span class="number">0</span>;</span><br><span class="line">            cache[i][j].vaild=<span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//读取文件</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">trace_test</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">    FILE *pFile;</span><br><span class="line">    pFile = fopen(file,<span class="string">&quot;r&quot;</span>);</span><br><span class="line">    <span class="keyword">if</span>(pFile==<span class="literal">NULL</span>)</span><br><span class="line">        <span class="built_in">exit</span>(<span class="number">-1</span>);</span><br><span class="line">    <span class="type">char</span> identifier;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">long</span> address;</span><br><span class="line">    <span class="type">int</span> size;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">int</span> address_c[<span class="number">3</span>];</span><br><span class="line">    <span class="keyword">while</span>(<span class="built_in">fscanf</span>(pFile,<span class="string">&quot; %c %lx,%d&quot;</span>,&amp;identifier,&amp;address,&amp;size)&gt;<span class="number">0</span>)   <span class="comment">//在读文件的时候，fscanf要判断条件要&gt;0,否则没有结束</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">//<span class="doctag">TODO:</span></span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">switch</span> (identifier) &#123;</span><br><span class="line">            <span class="keyword">case</span> <span class="string">&#x27;I&#x27;</span>:</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> <span class="string">&#x27;L&#x27;</span>:</span><br><span class="line">                <span class="keyword">if</span>(v==<span class="number">1</span>)</span><br><span class="line">                &#123;</span><br><span class="line">                    <span class="built_in">printf</span>(<span class="string">&quot;%c %lx %d,&quot;</span>,identifier,address,size);</span><br><span class="line">                &#125;</span><br><span class="line">                Split(address_c,address);</span><br><span class="line">                Search(address,address_c);</span><br><span class="line">                <span class="keyword">if</span>(v==<span class="number">1</span>)</span><br><span class="line">                    <span class="built_in">printf</span>(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> <span class="string">&#x27;S&#x27;</span>:</span><br><span class="line">                <span class="keyword">if</span>(v==<span class="number">1</span>)</span><br><span class="line">                &#123;</span><br><span class="line">                    <span class="built_in">printf</span>(<span class="string">&quot;%c %lx %d,&quot;</span>,identifier,address,size);</span><br><span class="line">                &#125;</span><br><span class="line">                Split(address_c,address);</span><br><span class="line">                Search(address,address_c);</span><br><span class="line">                <span class="keyword">if</span>(v==<span class="number">1</span>)</span><br><span class="line">                    <span class="built_in">printf</span>(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> <span class="string">&#x27;M&#x27;</span>:</span><br><span class="line">                <span class="keyword">if</span>(v==<span class="number">1</span>)</span><br><span class="line">                &#123;</span><br><span class="line">                    <span class="built_in">printf</span>(<span class="string">&quot;%c %lx %d,&quot;</span>,identifier,address,size);</span><br><span class="line">                &#125;</span><br><span class="line">                Split(address_c,address);</span><br><span class="line">                Search(address,address_c);</span><br><span class="line">                Search(address,address_c);</span><br><span class="line">                <span class="keyword">if</span>(v==<span class="number">1</span>)</span><br><span class="line">                    <span class="built_in">printf</span>(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">    fclose(pFile);</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">(<span class="type">int</span> argc ,<span class="type">char</span>** argv)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">int</span> opt;</span><br><span class="line">    <span class="keyword">while</span>(<span class="number">-1</span>!=(opt = getopt(argc, argv,<span class="string">&quot;vhs:E:b:t:&quot;</span>)))  <span class="comment">//分解操作符</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">switch</span>(opt)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">case</span> <span class="string">&#x27;h&#x27;</span>:</span><br><span class="line">                <span class="built_in">puts</span>(usage);</span><br><span class="line">                <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">            <span class="keyword">case</span><span class="number">&#x27;</span>v<span class="number">&#x27;</span>:</span><br><span class="line">                v = <span class="number">1</span>;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> <span class="string">&#x27;s&#x27;</span>:</span><br><span class="line">                s = atoi(optarg);</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> <span class="string">&#x27;E&#x27;</span>:</span><br><span class="line">                E = atoi(optarg);</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> <span class="string">&#x27;b&#x27;</span>:</span><br><span class="line">                b=atoi(optarg);</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> <span class="string">&#x27;t&#x27;</span>:</span><br><span class="line">                <span class="built_in">strcpy</span>(file, optarg);</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">default</span>:</span><br><span class="line">                <span class="built_in">printf</span>(<span class="string">&quot;wrong argument\n&quot;</span>);</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(s&lt;=<span class="number">0</span> || E&lt;=<span class="number">0</span> || b&lt;=<span class="number">0</span> || file==<span class="literal">NULL</span>) <span class="comment">// 如果选项参数不合格就退出</span></span><br><span class="line">        <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line"></span><br><span class="line">    S=<span class="number">1</span>&lt;&lt;s;   <span class="comment">//S=2^s</span></span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;s<span class="number">-1</span>;i++)</span><br><span class="line">    &#123;</span><br><span class="line">        mask1=mask1&lt;&lt;<span class="number">1</span>;</span><br><span class="line">        mask1=mask1|<span class="number">0x1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;s+b<span class="number">-1</span>;i++)</span><br><span class="line">    &#123;</span><br><span class="line">        mask2=mask2&lt;&lt;<span class="number">1</span>;</span><br><span class="line">        mask2=mask2|<span class="number">0x1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    init_Cache(s,E,b);  <span class="comment">//初始化cache内存空间</span></span><br><span class="line">    trace_test();    </span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span> ;i&lt;S;i++)   <span class="comment">//释放空间</span></span><br><span class="line">        <span class="built_in">free</span>(cache[i]);</span><br><span class="line">    <span class="built_in">free</span>(cache);</span><br><span class="line"></span><br><span class="line">    printSummary(hits, misss, evictions);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>





<h2 id="lab-A结果"><a href="#lab-A结果" class="headerlink" title="lab A结果"></a>lab A结果</h2><p><img data-fancybox="gallery" src="C:\Users\DELL\AppData\Roaming\Typora\typora-user-images\image-20220227171640249.png" alt="image-20220227171640249" data-caption="image-20220227171640249" loading="lazy"></p>
<h2 id="Lab-B"><a href="#Lab-B" class="headerlink" title="Lab B"></a>Lab B</h2><h3 id="1、分析test-trans"><a href="#1、分析test-trans" class="headerlink" title="1、分析test_trans"></a>1、分析test_trans</h3><p>他会根据输入的矩阵规模生成一段如LabA中的测试文档</p>
<p>如下（- M 2 -N 2）</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">S 0068212c,1</span><br><span class="line">L 00682160,8</span><br><span class="line">L 00682124,4</span><br><span class="line">L 00682120,4</span><br><span class="line">L 00602120,4</span><br><span class="line">S 00642120,4</span><br><span class="line">L 00602124,4</span><br><span class="line">S 00642128,4</span><br><span class="line">L 00602128,4</span><br><span class="line">S 00642124,4</span><br><span class="line">L 0060212c,4</span><br><span class="line">S 0064212c,4</span><br><span class="line">S 0068212d,1</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>转化为二进制比较好观察</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">1101000001000         01001                01100  miss</span><br><span class="line">1101000001000         01011                00000  miss</span><br><span class="line">1101000001000         01001                00100  hit</span><br><span class="line">1101000001000         01001                00000  hit</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">1100000001000         01001                00000  miss evi</span><br><span class="line"></span><br><span class="line">1100100001000         01001                00000  </span><br><span class="line"></span><br><span class="line">1100000001000         01001                00100</span><br><span class="line"></span><br><span class="line">1100100001000         01001                01000</span><br><span class="line"></span><br><span class="line">1100000001000         01001                01000</span><br><span class="line"></span><br><span class="line">1100100001000         01001                00100</span><br><span class="line">1100000001000         01001                01100</span><br><span class="line">1101000001000         01001                01101</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<p>一个cache块可以存储8个int（32/4）</p>
<p>那么连续访问4个相同的就可以使命中率高一些？</p>
<h3 id="2、测试："><a href="#2、测试：" class="headerlink" title="2、测试："></a>2、测试：</h3><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">char</span> trans_desc_1[] = <span class="string">&quot;step is 4 to transpose&quot;</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">trans1_decs</span><span class="params">( <span class="type">int</span> M, <span class="type">int</span> N, <span class="type">int</span> A[N][M], <span class="type">int</span> B[M][N])</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">int</span> temp1=<span class="number">0</span>,temp2=<span class="number">0</span>,temp3=<span class="number">0</span>,temp4=<span class="number">0</span>;</span><br><span class="line">    temp1=A[<span class="number">0</span>][<span class="number">0</span>];</span><br><span class="line">    temp2=A[<span class="number">0</span>][<span class="number">1</span>];</span><br><span class="line">    temp3=A[<span class="number">1</span>][<span class="number">0</span>];</span><br><span class="line">    temp4=A[<span class="number">1</span>][<span class="number">1</span>];</span><br><span class="line">    B[<span class="number">0</span>][<span class="number">0</span>]=temp1;</span><br><span class="line">    B[<span class="number">0</span>][<span class="number">1</span>]=temp3;</span><br><span class="line">    B[<span class="number">1</span>][<span class="number">0</span>]=temp2;</span><br><span class="line">    B[<span class="number">1</span>][<span class="number">1</span>]=temp4;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<p><img data-fancybox="gallery" src="C:\Users\DELL\AppData\Roaming\Typora\typora-user-images\image-20220228145950516.png" alt="image-20220228145950516" data-caption="image-20220228145950516" loading="lazy"></p>
<p>猜测正确</p>
<p>继续思考，采取先取一定数量的A，在放入一定数量的B中。</p>
<p>由于有变量个数的限制，所以对于32*32的矩阵来说，可以将其进行分块，分块以后再每个小矩阵里进行操作</p>
<p>一次的取数最好为4的倍数，一人用16个块是最理想的，先试着分为16个 8*8 的矩阵。</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">char</span> transpose_submit_desc1[] = <span class="string">&quot;Transpose submission  1&quot;</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">transpose_submit1</span><span class="params">(<span class="type">int</span> M, <span class="type">int</span> N, <span class="type">int</span> A[N][M], <span class="type">int</span> B[M][N])</span> &#123;</span><br><span class="line">    <span class="type">int</span> i,j,k,l;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(M==<span class="number">32</span>&amp;&amp;N==<span class="number">32</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;<span class="number">4</span>;i++)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">for</span>(j=<span class="number">0</span>;j&lt;<span class="number">4</span>;j++)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">for</span>(k=<span class="number">8</span>*i;k&lt;<span class="number">8</span>*i+<span class="number">8</span>;k++)</span><br><span class="line">                &#123;</span><br><span class="line">                    <span class="keyword">for</span>(l=<span class="number">8</span>*j;l&lt;<span class="number">8</span>*j+<span class="number">8</span>;l++)</span><br><span class="line">                    &#123;</span><br><span class="line">                            B[l][k]=A[k][l];</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>得到如下结果：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">func 1 (Transpose submission  1): hits:1710, misses:343, evictions:311</span><br></pre></td></tr></table></figure>

<p>misses=343&gt;300 ，这并不是一个满分结果，寻找有没有改进方法。</p>
<h3 id="3、改进"><a href="#3、改进" class="headerlink" title="3、改进"></a>3、改进</h3><p>可以对对角线的元素动刀。</p>
<p>我们发现上述代码A每次是按照cache取的，而B每次都需要重新装填。</p>
<p>如果最后处理在遍历完A的一个小矩阵后，最后处理对角线元素，则B的对角线元素也会和后面的3个元素一起装填，在下一时候会多命中一个。大概最后会减少60个左右miss</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">char</span> transpose_submit_desc1[] = <span class="string">&quot;Transpose submission  1&quot;</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">transpose_submit1</span><span class="params">(<span class="type">int</span> M, <span class="type">int</span> N, <span class="type">int</span> A[N][M], <span class="type">int</span> B[M][N])</span> &#123;</span><br><span class="line">    <span class="type">int</span> i,j,k,l;</span><br><span class="line">    <span class="type">int</span> same=<span class="number">0</span>,index;</span><br><span class="line">    <span class="keyword">if</span>(M==<span class="number">32</span>&amp;&amp;N==<span class="number">32</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;<span class="number">4</span>;i++)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">for</span>(j=<span class="number">0</span>;j&lt;<span class="number">4</span>;j++)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">for</span>(k=<span class="number">8</span>*i;k&lt;<span class="number">8</span>*i+<span class="number">8</span>;k++)</span><br><span class="line">                &#123;</span><br><span class="line">                    <span class="keyword">for</span>(l=<span class="number">8</span>*j;l&lt;<span class="number">8</span>*j+<span class="number">8</span>;l++)</span><br><span class="line">                    &#123;</span><br><span class="line">                            <span class="keyword">if</span>(l!=k)</span><br><span class="line">                            &#123;</span><br><span class="line">                                B[l][k]=A[k][l];</span><br><span class="line">                            &#125;</span><br><span class="line">                            <span class="keyword">else</span></span><br><span class="line">                            &#123;</span><br><span class="line">                                same=A[l][l];</span><br><span class="line">                                index=l;</span><br><span class="line">                            &#125;</span><br><span class="line"></span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="keyword">if</span>(index==k)</span><br><span class="line">                    &#123;</span><br><span class="line">                        B[index][index]=same;</span><br><span class="line">                    &#125;</span><br><span class="line"></span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h2 id="M-64-N-64"><a href="#M-64-N-64" class="headerlink" title="-M 64 -N 64"></a>-M 64 -N 64</h2><p>直接测试32*32的方法</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">void</span> <span class="title function_">trans_2</span><span class="params">(<span class="type">int</span> M, <span class="type">int</span> N, <span class="type">int</span> A[N][M], <span class="type">int</span> B[M][N])</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; N; i += <span class="number">8</span>)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">for</span>(<span class="type">int</span> j = <span class="number">0</span>; j &lt; M; j += <span class="number">8</span>)</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="keyword">for</span>(<span class="type">int</span> ii = i; ii &lt; i + <span class="number">8</span>; ii++)</span><br><span class="line">			&#123;</span><br><span class="line">				<span class="keyword">for</span>(<span class="type">int</span> jj = j; jj &lt; j + <span class="number">8</span>; jj++)</span><br><span class="line">					B[jj][ii] = A[ii][jj];</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<p>misses:4663，0分。</p>
<p>看一下内存访问的次序，可以发现</p>
<p><img data-fancybox="gallery" src="C:\Users\DELL\AppData\Roaming\Typora\typora-user-images\image-20220302130034008.png" alt="image-20220302130034008" data-caption="image-20220302130034008" loading="lazy"></p>
<p>与</p>
<p><img data-fancybox="gallery" src="C:\Users\DELL\AppData\Roaming\Typora\typora-user-images\image-20220302130050907.png" alt="image-20220302130050907" data-caption="image-20220302130050907" loading="lazy"></p>
<p>会发生冲突。</p>
<p>在同一个8*8的块内就会发生冲突。</p>
<p>所以考虑变成4*4的块</p>
<p>misses:1914 ，可以发现大幅度降低。</p>
<p>但是还是达不到满分的要求。</p>
<p>想了很久还是没有方法，所以参考一下网络大神们的方法..</p>
<p><a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/28585726">猫大神</a></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"></span><br></pre></td></tr></table></figure>







<h2 id="M-61-N-67"><a href="#M-61-N-67" class="headerlink" title="-M 61 -N 67"></a>-M 61 -N 67</h2><p>不规则的matrix，本质也是用分块来优化Cache的读写，但是不能找到比较显然的规律看出来间隔多少可以填满一个Cache，但是由于要求比较松，我们可以尝试一些分块的大小，直接进行转置操作。尝试到16左右 ，可以小于2000次miss。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"></span><br></pre></td></tr></table></figure>



<h2 id="完整代码"><a href="#完整代码" class="headerlink" title="完整代码"></a>完整代码</h2><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">void</span> <span class="title function_">transpose_submit</span><span class="params">(<span class="type">int</span> M, <span class="type">int</span> N, <span class="type">int</span> A[N][M], <span class="type">int</span> B[M][N])</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">//you are allowed to define at most 12 local variables of type int</span></span><br><span class="line">    <span class="comment">//per transpose function.</span></span><br><span class="line"></span><br><span class="line">    <span class="type">int</span> sets_num = M/<span class="number">8</span>;</span><br><span class="line">    <span class="type">int</span> sets_remainder = M%<span class="number">8</span>;</span><br><span class="line"></span><br><span class="line">    <span class="type">int</span> i, j, k, l;</span><br><span class="line">    <span class="type">int</span> f, g, h;</span><br><span class="line"></span><br><span class="line">    <span class="type">int</span> tmp, same;</span><br><span class="line">    <span class="comment">//int same;</span></span><br><span class="line">    <span class="comment">/*blocking: divide the matrix into sub-matrices.</span></span><br><span class="line"><span class="comment">		size of sub-matrix depends on cache block size, cache size,</span></span><br><span class="line"><span class="comment">		input matrix size.*/</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/**32 X 32 ***************************************************************/</span></span><br><span class="line">    <span class="keyword">if</span> (M == <span class="number">32</span> &amp;&amp; N == <span class="number">32</span>)&#123;</span><br><span class="line">        <span class="comment">//divide the matrix into 8*8 block and be careful for the i == j eviction</span></span><br><span class="line">        <span class="keyword">for</span>(l=<span class="number">0</span>; l &lt; <span class="number">4</span>; l++)&#123;</span><br><span class="line">            <span class="keyword">for</span>(k=<span class="number">0</span>; k &lt; <span class="number">4</span>; k++)&#123;</span><br><span class="line">                <span class="comment">/*block size 8 * 8 */</span></span><br><span class="line">                <span class="keyword">for</span> (i = l*<span class="number">8</span>; i &lt; l*<span class="number">8</span>+<span class="number">8</span>; i++)&#123;</span><br><span class="line">                    <span class="keyword">for</span> (j = k*<span class="number">8</span>; j &lt; k*<span class="number">8</span>+<span class="number">8</span>; j++) &#123;</span><br><span class="line">                        <span class="keyword">if</span>(i!=j) &#123;</span><br><span class="line">                            B[j][i]=A[i][j];</span><br><span class="line">                        &#125; <span class="comment">//special handling for same block</span></span><br><span class="line">                        <span class="keyword">else</span>&#123;</span><br><span class="line">                            <span class="comment">//B[j][i] = A[i][j] for the same i, j will cause cache miss.</span></span><br><span class="line">                            <span class="comment">//=&gt; do the calculation at the end</span></span><br><span class="line">                            tmp=A[j][j];</span><br><span class="line">                            same = j;</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="keyword">if</span>(k==l)&#123;</span><br><span class="line">                        B[same][same] = tmp;</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="comment">/**************************/</span></span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"><span class="comment">/**32 X 32 ***************************************************************/</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/**64 X 64 ***************************************************************/</span></span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> (M==<span class="number">64</span> &amp;&amp; N == <span class="number">64</span>)&#123;</span><br><span class="line">        <span class="comment">/* divide the matrix into 8*8 blocks,</span></span><br><span class="line"><span class="comment">     do the calculation separately for upper half and lower half */</span></span><br><span class="line">        <span class="comment">//variables don&#x27;t mean anything here. Just reusing because limited.</span></span><br><span class="line">        <span class="keyword">for</span>(i=<span class="number">0</span>; i&lt;<span class="number">64</span>; i+=<span class="number">8</span>)&#123;</span><br><span class="line">            <span class="keyword">for</span>(j=<span class="number">0</span>; j&lt;<span class="number">64</span>; j+=<span class="number">8</span>)&#123;</span><br><span class="line"></span><br><span class="line">                <span class="keyword">for</span>(k=<span class="number">0</span>; k&lt;<span class="number">4</span>; k++)&#123;</span><br><span class="line">                    l = A[i+k][j+<span class="number">0</span>];</span><br><span class="line">                    tmp = A[i+k][j+<span class="number">1</span>];</span><br><span class="line">                    same = A[i+k][j+<span class="number">2</span>];</span><br><span class="line"></span><br><span class="line">                    sets_remainder = A[i+k][j+<span class="number">3</span>];</span><br><span class="line">                    sets_num = A[i+k][j+<span class="number">4</span>];</span><br><span class="line"></span><br><span class="line">                    f = A[i+k][j+<span class="number">5</span>];</span><br><span class="line">                    g = A[i+k][j+<span class="number">6</span>];</span><br><span class="line">                    h = A[i+k][j+<span class="number">7</span>];</span><br><span class="line"></span><br><span class="line">                    B[j+<span class="number">0</span>][i+k+<span class="number">0</span>] = l;</span><br><span class="line">                    B[j+<span class="number">0</span>][i+k+<span class="number">4</span>] = f;</span><br><span class="line">                    B[j+<span class="number">1</span>][i+k+<span class="number">0</span>] = tmp;</span><br><span class="line">                    B[j+<span class="number">1</span>][i+k+<span class="number">4</span>] = g;</span><br><span class="line">                    B[j+<span class="number">2</span>][i+k+<span class="number">0</span>] = same;</span><br><span class="line">                    B[j+<span class="number">2</span>][i+k+<span class="number">4</span>] = h;</span><br><span class="line">                    B[j+<span class="number">3</span>][i+k+<span class="number">0</span>] = sets_remainder;</span><br><span class="line">                    B[j+<span class="number">3</span>][i+k+<span class="number">4</span>] = sets_num;</span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">                l = A[i+<span class="number">4</span>][j+<span class="number">4</span>];</span><br><span class="line">                tmp = A[i+<span class="number">5</span>][j+<span class="number">4</span>];</span><br><span class="line">                same = A[i+<span class="number">6</span>][j+<span class="number">4</span>];</span><br><span class="line"></span><br><span class="line">                sets_remainder = A[i+<span class="number">7</span>][j+<span class="number">4</span>];</span><br><span class="line">                sets_num = A[i+<span class="number">4</span>][j+<span class="number">3</span>];</span><br><span class="line"></span><br><span class="line">                f = A[i+<span class="number">5</span>][j+<span class="number">3</span>];</span><br><span class="line">                g = A[i+<span class="number">6</span>][j+<span class="number">3</span>];</span><br><span class="line">                h = A[i+<span class="number">7</span>][j+<span class="number">3</span>];</span><br><span class="line"></span><br><span class="line">                B[j+<span class="number">4</span>][i+<span class="number">0</span>] = B[j+<span class="number">3</span>][i+<span class="number">4</span>];</span><br><span class="line">                B[j+<span class="number">4</span>][i+<span class="number">4</span>] = l;</span><br><span class="line">                B[j+<span class="number">3</span>][i+<span class="number">4</span>] = sets_num;</span><br><span class="line">                B[j+<span class="number">4</span>][i+<span class="number">1</span>] = B[j+<span class="number">3</span>][i+<span class="number">5</span>];</span><br><span class="line">                B[j+<span class="number">4</span>][i+<span class="number">5</span>] = tmp;</span><br><span class="line">                B[j+<span class="number">3</span>][i+<span class="number">5</span>] = f;</span><br><span class="line">                B[j+<span class="number">4</span>][i+<span class="number">2</span>] = B[j+<span class="number">3</span>][i+<span class="number">6</span>];</span><br><span class="line">                B[j+<span class="number">4</span>][i+<span class="number">6</span>] = same;</span><br><span class="line">                B[j+<span class="number">3</span>][i+<span class="number">6</span>] = g;</span><br><span class="line">                B[j+<span class="number">4</span>][i+<span class="number">3</span>] = B[j+<span class="number">3</span>][i+<span class="number">7</span>];</span><br><span class="line">                B[j+<span class="number">4</span>][i+<span class="number">7</span>] = sets_remainder;</span><br><span class="line">                B[j+<span class="number">3</span>][i+<span class="number">7</span>] = h;</span><br><span class="line"></span><br><span class="line">                <span class="keyword">for</span>(k=<span class="number">0</span>;k&lt;<span class="number">3</span>;k++)&#123;</span><br><span class="line"></span><br><span class="line">                    l = A[i+<span class="number">4</span>][j+<span class="number">5</span>+k];</span><br><span class="line">                    tmp = A[i+<span class="number">5</span>][j+<span class="number">5</span>+k];</span><br><span class="line">                    same = A[i+<span class="number">6</span>][j+<span class="number">5</span>+k];</span><br><span class="line">                    sets_remainder = A[i+<span class="number">7</span>][j+<span class="number">5</span>+k];</span><br><span class="line">                    sets_num = A[i+<span class="number">4</span>][j+k];</span><br><span class="line">                    f = A[i+<span class="number">5</span>][j+k];</span><br><span class="line">                    g = A[i+<span class="number">6</span>][j+k];</span><br><span class="line">                    h = A[i+<span class="number">7</span>][j+k];</span><br><span class="line"></span><br><span class="line">                    B[j+<span class="number">5</span>+k][i+<span class="number">0</span>] = B[j+k][i+<span class="number">4</span>];</span><br><span class="line">                    B[j+<span class="number">5</span>+k][i+<span class="number">4</span>] = l;</span><br><span class="line">                    B[j+k][i+<span class="number">4</span>] = sets_num;</span><br><span class="line">                    B[j+<span class="number">5</span>+k][i+<span class="number">1</span>] = B[j+k][i+<span class="number">5</span>];</span><br><span class="line">                    B[j+<span class="number">5</span>+k][i+<span class="number">5</span>] = tmp;</span><br><span class="line">                    B[j+k][i+<span class="number">5</span>] = f;</span><br><span class="line">                    B[j+<span class="number">5</span>+k][i+<span class="number">2</span>] = B[j+k][i+<span class="number">6</span>];</span><br><span class="line">                    B[j+<span class="number">5</span>+k][i+<span class="number">6</span>] = same;</span><br><span class="line">                    B[j+k][i+<span class="number">6</span>] = g;</span><br><span class="line">                    B[j+<span class="number">5</span>+k][i+<span class="number">3</span>] = B[j+k][i+<span class="number">7</span>];</span><br><span class="line">                    B[j+<span class="number">5</span>+k][i+<span class="number">7</span>] = sets_remainder;</span><br><span class="line">                    B[j+k][i+<span class="number">7</span>] = h;</span><br><span class="line"></span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"><span class="comment">/**64 X 64 ***************************************************************/</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/**61 X 67 ***************************************************************/</span></span><br><span class="line">    <span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; N; i+=<span class="number">8</span>) &#123;</span><br><span class="line">            <span class="keyword">for</span> (j = <span class="number">0</span>; j &lt; M; j+= <span class="number">8</span>) &#123;</span><br><span class="line">                <span class="keyword">for</span> (k = j;(k&lt;j+<span class="number">8</span>) &amp;&amp; (k&lt;M);++k) &#123;</span><br><span class="line">                    <span class="keyword">for</span> (l = i; (l&lt;i+<span class="number">8</span>)&amp;&amp;(l&lt;N); ++l) &#123;</span><br><span class="line">                        B[k][l] = A[l][k];</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"><span class="comment">/**61 X 67 ***************************************************************/</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


  </article>

  
      
    <div class="nexmoe-post-copyright">
        <strong>本文作者：</strong>GuoYu_LLR<br>
        <strong>本文链接：</strong><a href="https://yuzi2233.github.io/2022/02/23/CacheLab/" title="https:&#x2F;&#x2F;yuzi2233.github.io&#x2F;2022&#x2F;02&#x2F;23&#x2F;CacheLab&#x2F;" target="_blank" rel="noopener">https:&#x2F;&#x2F;yuzi2233.github.io&#x2F;2022&#x2F;02&#x2F;23&#x2F;CacheLab&#x2F;</a><br>
        
            <strong>版权声明：</strong>本文采用 <a href="https://creativecommons.org/licenses/by-nc-sa/3.0/cn/deed.zh" target="_blank">CC BY-NC-SA 3.0 CN</a> 协议进行许可
        
    </div>


  
  
  <div class="nexmoe-post-meta nexmoe-rainbow">
    
    
</div>

  
      <div class="nexmoe-post-footer">
          <section class="nexmoe-comment">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/gitalk@latest/dist/gitalk.min.css">
<div id="gitalk"></div>
<script src="https://cdn.jsdelivr.net/npm/gitalk@latest/dist/gitalk.min.js"></script>
<script type="text/javascript">
    var gitalk = new Gitalk({
        clientID: '80b2453b6d5f37ad6225',
        clientSecret: '43e99fa852795c9a7b3eb924b2558c64b84bbdeb',
        id: window.location.pathname,
        repo: 'nexmoe.github.io',
        owner: 'nexmoe',
        admin: 'nexmoe'
    })
    gitalk.render('gitalk')
</script>
</section>
      </div>
  
</div>
            <div class="nexmoe-post-right">
              <div class="nexmoe-fixed">
                  <div class="nexmoe-tool"> 
                    
                      
                    
                      <a href="#nexmoe-content" class="toc-link" aria-label="回到顶部" title="top"><button class="mdui-fab mdui-ripple"><i class="nexmoefont icon-caret-top"></i></button></a>
                  </div>
              </div>
            </div>
        </div>
    </div>
     
    <div id="nexmoe-search-space">
        <div class="search-container">
            <div class="search-header">
                <div class="search-input-container">
                    <input class="search-input" type="text" placeholder="搜索" oninput="sinput();">
                </div>
                <a class="search-close" onclick="sclose();">×</a>
            </div>
            <div class="search-body"></div>
        </div>
    </div>

    
<script src="/lib/mdui_043tiny/mdui.js"></script>
<script src="/lib/jquery.min.js"></script>
<script src="/lib/justifiedGallery/jquery.justifiedGallery.min.js"></script>
<script src="/lib/fancybox/fancybox.umd.js"></script>


 

<script async src="/js/app.js?v=1676628166823"></script>



<script>
	$(".justified-gallery").justifiedGallery({
		rowHeight: 160,
		margins: 10,
	});
</script>


    





</body>

</html>
